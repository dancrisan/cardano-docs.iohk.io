<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Pos.DB.GState</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Pos-DB-GState.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Pos.DB.GState.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">cardano-sl-0.2.0: Cardano SL main implementation</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Pos.DB.GState</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Getters</a></li><li><a href="#g:2">Operations</a></li><li><a href="#g:3">Initialization</a></li><li><a href="#g:4">Iteration</a></li><li><a href="#g:5">Sanity checks</a></li><li><a href="#g:6">Getters</a></li><li><a href="#g:7">Initialization</a></li><li><a href="#g:8">Helpers</a></li><li><a href="#g:9">Operations</a></li><li><a href="#g:10">Getters</a></li><li><a href="#g:11">Operations</a></li><li><a href="#g:12">Initialization</a></li><li><a href="#g:13">Iteration</a></li><li><a href="#g:14">Getters</a></li><li><a href="#g:15">Operations</a></li><li><a href="#g:16">Initialization</a></li><li><a href="#g:17">Iteration</a></li><li><a href="#g:18">Sanity checks</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>GState DB stores whole global state, i. e. result of application
 of all blocks up to <em>tip</em>.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:getTotalFtsStake">getTotalFtsStake</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m <a href="Pos-Types.html#t:Coin">Coin</a></li><li class="src short"><a href="#v:getFtsStake">getFtsStake</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Address.html#t:StakeholderId">StakeholderId</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Types.html#t:Coin">Coin</a>)</li><li class="src short"><a href="#v:getFtsStakeFromDB">getFtsStakeFromDB</a> :: (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m, MonadThrow m) =&gt; <a href="Pos-Types-Address.html#t:StakeholderId">StakeholderId</a> -&gt; <a href="Pos-DB.html#t:DB">DB</a> ssc -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Types.html#t:Coin">Coin</a>)</li><li class="src short"><span class="keyword">data</span> <a href="#t:BalancesOp">BalancesOp</a><ul class="subs"><li>= <a href="#v:PutFtsSum">PutFtsSum</a> !<a href="Pos-Types.html#t:Coin">Coin</a></li><li>| <a href="#v:PutFtsStake">PutFtsStake</a> !<a href="Pos-Types-Address.html#t:StakeholderId">StakeholderId</a> !<a href="Pos-Types.html#t:Coin">Coin</a></li></ul></li><li class="src short"><a href="#v:prepareGStateBalances">prepareGStateBalances</a> :: <span class="keyword">forall</span> ssc m. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Types.html#t:Utxo">Utxo</a> -&gt; m ()</li><li class="src short"><span class="keyword">data</span> <a href="#t:BalIter">BalIter</a></li><li class="src short"><a href="#v:runBalanceIterator">runBalanceIterator</a> :: <span class="keyword">forall</span> m ssc a. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-DB.html#t:DBnIterator">DBnIterator</a> ssc <a href="Pos-DB-GState.html#t:BalIter">BalIter</a> a -&gt; m a</li><li class="src short"><a href="#v:runBalanceMapIterator">runBalanceMapIterator</a> :: <span class="keyword">forall</span> v m ssc a. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-DB.html#t:DBnMapIterator">DBnMapIterator</a> ssc <a href="Pos-DB-GState.html#t:BalIter">BalIter</a> v a -&gt; (<a href="Pos-DB.html#t:IterType">IterType</a> <a href="Pos-DB-GState.html#t:BalIter">BalIter</a> -&gt; v) -&gt; m a</li><li class="src short"><a href="#v:sanityCheckBalances">sanityCheckBalances</a> :: (MonadMask m, <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m, WithLogger m) =&gt; m ()</li><li class="src short"><a href="#v:resolveForwardLink">resolveForwardLink</a> :: (<a href="Pos-Types.html#t:HasHeaderHash">HasHeaderHash</a> a, <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m) =&gt; a -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a>)</li><li class="src short"><a href="#v:isBlockInMainChain">isBlockInMainChain</a> :: (<a href="Pos-Types.html#t:HasHeaderHash">HasHeaderHash</a> a, <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m) =&gt; a -&gt; m <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:BlockExtraOp">BlockExtraOp</a><ul class="subs"><li>= <a href="#v:AddForwardLink">AddForwardLink</a> <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a> <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a></li><li>| <a href="#v:RemoveForwardLink">RemoveForwardLink</a> <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a></li><li>| <a href="#v:SetInMainChain">SetInMainChain</a> <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Bool.html#t:Bool">Bool</a> <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a></li></ul></li><li class="src short"><a href="#v:loadHeadersUpWhile">loadHeadersUpWhile</a> :: (<a href="Pos-Ssc-Class.html#t:SscHelpersClass">SscHelpersClass</a> ssc, <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m, <a href="Pos-Types.html#t:HasHeaderHash">HasHeaderHash</a> a) =&gt; a -&gt; (<a href="Pos-Types-Block-Types.html#t:BlockHeader">BlockHeader</a> ssc -&gt; <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Bool.html#t:Bool">Bool</a>) -&gt; m (<a href="Pos-Util.html#t:OldestFirst">OldestFirst</a> [] (<a href="Pos-Types-Block-Types.html#t:BlockHeader">BlockHeader</a> ssc))</li><li class="src short"><a href="#v:loadBlocksUpWhile">loadBlocksUpWhile</a> :: (<a href="Pos-Ssc-Class.html#t:SscHelpersClass">SscHelpersClass</a> ssc, <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m, <a href="Pos-Types.html#t:HasHeaderHash">HasHeaderHash</a> a) =&gt; a -&gt; (<a href="Pos-Types-Block-Types.html#t:Block">Block</a> ssc -&gt; <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Bool.html#t:Bool">Bool</a>) -&gt; m (<a href="Pos-Util.html#t:OldestFirst">OldestFirst</a> [] (<a href="Pos-Types-Block-Types.html#t:Block">Block</a> ssc))</li><li class="src short"><a href="#v:prepareGStateBlockExtra">prepareGStateBlockExtra</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a> -&gt; m ()</li><li class="src short"><a href="#v:getTip">getTip</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a></li><li class="src short"><a href="#v:getBot">getBot</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a></li><li class="src short"><a href="#v:prepareGStateCommon">prepareGStateCommon</a> :: <span class="keyword">forall</span> ssc m. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a> -&gt; m ()</li><li class="src short"><a href="#v:getBi">getBi</a> :: (<a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m, <a href="Pos-Binary.html#t:Bi">Bi</a> v) =&gt; <a href="http://hackage.haskell.org/package/bytestring-0.10.8.1/docs/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> v)</li><li class="src short"><a href="#v:putBi">putBi</a> :: (<a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m, <a href="Pos-Binary.html#t:Bi">Bi</a> v) =&gt; <a href="http://hackage.haskell.org/package/bytestring-0.10.8.1/docs/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; v -&gt; m ()</li><li class="src short"><a href="#v:delete">delete</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="http://hackage.haskell.org/package/bytestring-0.10.8.1/docs/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; m ()</li><li class="src short"><a href="#v:writeBatchGState">writeBatchGState</a> :: (<a href="Pos-DB.html#t:RocksBatchOp">RocksBatchOp</a> a, <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m) =&gt; [a] -&gt; m ()</li><li class="src short"><span class="keyword">data</span> <a href="#t:CommonOp">CommonOp</a> = <a href="#v:PutTip">PutTip</a> <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a></li><li class="src short"><a href="#v:getPSKByIssuerAddressHash">getPSKByIssuerAddressHash</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Address.html#t:StakeholderId">StakeholderId</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Types-Types.html#t:ProxySKHeavy">ProxySKHeavy</a>)</li><li class="src short"><a href="#v:getPSKByIssuer">getPSKByIssuer</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Crypto.html#t:PublicKey">PublicKey</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Types-Types.html#t:ProxySKHeavy">ProxySKHeavy</a>)</li><li class="src short"><a href="#v:isIssuerByAddressHash">isIssuerByAddressHash</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Address.html#t:StakeholderId">StakeholderId</a> -&gt; m <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:DelegationOp">DelegationOp</a><ul class="subs"><li>= <a href="#v:AddPSK">AddPSK</a> !<a href="Pos-Types-Types.html#t:ProxySKHeavy">ProxySKHeavy</a></li><li>| <a href="#v:DelPSK">DelPSK</a> !<a href="Pos-Crypto.html#t:PublicKey">PublicKey</a></li></ul></li><li class="src short"><a href="#v:runPskIterator">runPskIterator</a> :: <span class="keyword">forall</span> m ssc a. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-DB.html#t:DBnIterator">DBnIterator</a> ssc PskIter a -&gt; m a</li><li class="src short"><a href="#v:runPskMapIterator">runPskMapIterator</a> :: <span class="keyword">forall</span> v m ssc a. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-DB.html#t:DBnMapIterator">DBnMapIterator</a> ssc PskIter v a -&gt; (<a href="Pos-DB.html#t:IterType">IterType</a> PskIter -&gt; v) -&gt; m a</li><li class="src short"><a href="#v:prepareGStateDB">prepareGStateDB</a> :: <span class="keyword">forall</span> ssc m. (<a href="Pos-Context.html#t:WithNodeContext">WithNodeContext</a> ssc m, <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m) =&gt; <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a> -&gt; m ()</li><li class="src short"><a href="#v:sanityCheckGStateDB">sanityCheckGStateDB</a> :: <span class="keyword">forall</span> ssc m. (<a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m, MonadMask m, WithLogger m) =&gt; m ()</li><li class="src short"><a href="#v:usingGStateSnapshot">usingGStateSnapshot</a> :: (<a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m, MonadMask m) =&gt; m a -&gt; m a</li><li class="src short"><a href="#v:getAdoptedBV">getAdoptedBV</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m <a href="Pos-Types-Version.html#t:BlockVersion">BlockVersion</a></li><li class="src short"><a href="#v:getAdoptedBVData">getAdoptedBVData</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m <a href="Pos-Update-Core.html#t:BlockVersionData">BlockVersionData</a></li><li class="src short"><a href="#v:getAdoptedBVFull">getAdoptedBVFull</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m (<a href="Pos-Types-Version.html#t:BlockVersion">BlockVersion</a>, <a href="Pos-Update-Core.html#t:BlockVersionData">BlockVersionData</a>)</li><li class="src short"><a href="#v:getBVState">getBVState</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Version.html#t:BlockVersion">BlockVersion</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Update.html#t:BlockVersionState">BlockVersionState</a>)</li><li class="src short"><a href="#v:getProposalState">getProposalState</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Update-Core.html#t:UpId">UpId</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Update.html#t:ProposalState">ProposalState</a>)</li><li class="src short"><a href="#v:getAppProposal">getAppProposal</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Version.html#t:ApplicationName">ApplicationName</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Update-Core.html#t:UpId">UpId</a>)</li><li class="src short"><a href="#v:getProposalStateByApp">getProposalStateByApp</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Version.html#t:ApplicationName">ApplicationName</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Update.html#t:ProposalState">ProposalState</a>)</li><li class="src short"><a href="#v:getConfirmedSV">getConfirmedSV</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Version.html#t:ApplicationName">ApplicationName</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Types-Version.html#t:NumSoftwareVersion">NumSoftwareVersion</a>)</li><li class="src short"><a href="#v:getMaxBlockSize">getMaxBlockSize</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m Byte</li><li class="src short"><a href="#v:getSlottingData">getSlottingData</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m <a href="Pos-Slotting.html#t:SlottingData">SlottingData</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:UpdateOp">UpdateOp</a><ul class="subs"><li>= <a href="#v:PutProposal">PutProposal</a> !<a href="Pos-Update.html#t:ProposalState">ProposalState</a></li><li>| <a href="#v:DeleteProposal">DeleteProposal</a> !<a href="Pos-Update-Core.html#t:UpId">UpId</a> !<a href="Pos-Types-Version.html#t:ApplicationName">ApplicationName</a></li><li>| <a href="#v:ConfirmVersion">ConfirmVersion</a> !<a href="Pos-Types-Version.html#t:SoftwareVersion">SoftwareVersion</a></li><li>| <a href="#v:DelConfirmedVersion">DelConfirmedVersion</a> !<a href="Pos-Types-Version.html#t:ApplicationName">ApplicationName</a></li><li>| <a href="#v:AddConfirmedProposal">AddConfirmedProposal</a> !<a href="Pos-Update.html#t:ConfirmedProposalState">ConfirmedProposalState</a></li><li>| <a href="#v:DelConfirmedProposal">DelConfirmedProposal</a> !<a href="Pos-Types-Version.html#t:SoftwareVersion">SoftwareVersion</a></li><li>| <a href="#v:SetAdopted">SetAdopted</a> !<a href="Pos-Types-Version.html#t:BlockVersion">BlockVersion</a> <a href="Pos-Update-Core.html#t:BlockVersionData">BlockVersionData</a></li><li>| <a href="#v:SetBVState">SetBVState</a> !<a href="Pos-Types-Version.html#t:BlockVersion">BlockVersion</a> !<a href="Pos-Update.html#t:BlockVersionState">BlockVersionState</a></li><li>| <a href="#v:DelBV">DelBV</a> !<a href="Pos-Types-Version.html#t:BlockVersion">BlockVersion</a></li><li>| <a href="#v:PutSlottingData">PutSlottingData</a> !<a href="Pos-Slotting.html#t:SlottingData">SlottingData</a></li></ul></li><li class="src short"><a href="#v:prepareGStateUS">prepareGStateUS</a> :: <span class="keyword">forall</span> ssc m. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Timestamp.html#t:Timestamp">Timestamp</a> -&gt; m ()</li><li class="src short"><span class="keyword">data</span> <a href="#t:PropIter">PropIter</a></li><li class="src short"><a href="#v:runProposalMapIterator">runProposalMapIterator</a> :: <span class="keyword">forall</span> v m ssc a. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-DB.html#t:DBnMapIterator">DBnMapIterator</a> ssc <a href="Pos-DB-GState.html#t:PropIter">PropIter</a> v a -&gt; (<a href="Pos-DB.html#t:IterType">IterType</a> <a href="Pos-DB-GState.html#t:PropIter">PropIter</a> -&gt; v) -&gt; m a</li><li class="src short"><a href="#v:runProposalIterator">runProposalIterator</a> :: <span class="keyword">forall</span> m ssc a. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-DB.html#t:DBnIterator">DBnIterator</a> ssc <a href="Pos-DB-GState.html#t:PropIter">PropIter</a> a -&gt; m a</li><li class="src short"><a href="#v:getOldProposals">getOldProposals</a> :: <span class="keyword">forall</span> ssc m. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types.html#t:SlotId">SlotId</a> -&gt; m [<a href="Pos-Update.html#t:UndecidedProposalState">UndecidedProposalState</a>]</li><li class="src short"><a href="#v:getDeepProposals">getDeepProposals</a> :: <span class="keyword">forall</span> ssc m. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types.html#t:ChainDifficulty">ChainDifficulty</a> -&gt; m [<a href="Pos-Update.html#t:DecidedProposalState">DecidedProposalState</a>]</li><li class="src short"><span class="keyword">data</span> <a href="#t:ConfPropIter">ConfPropIter</a></li><li class="src short"><a href="#v:getConfirmedProposals">getConfirmedProposals</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Types-Version.html#t:NumSoftwareVersion">NumSoftwareVersion</a> -&gt; m [<a href="Pos-Update.html#t:ConfirmedProposalState">ConfirmedProposalState</a>]</li><li class="src short"><span class="keyword">data</span> <a href="#t:BVIter">BVIter</a></li><li class="src short"><a href="#v:getProposedBVs">getProposedBVs</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m [<a href="Pos-Types-Version.html#t:BlockVersion">BlockVersion</a>]</li><li class="src short"><a href="#v:getConfirmedBVStates">getConfirmedBVStates</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m [(<a href="Pos-Types-Version.html#t:BlockVersion">BlockVersion</a>, <a href="Pos-Update.html#t:BlockVersionState">BlockVersionState</a>)]</li><li class="src short"><a href="#v:getProposedBVStates">getProposedBVStates</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m [<a href="Pos-Update.html#t:BlockVersionState">BlockVersionState</a>]</li><li class="src short"><a href="#v:getGenUtxo">getGenUtxo</a> :: (MonadThrow m, <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m) =&gt; m <a href="Pos-Types-Types.html#t:Utxo">Utxo</a></li><li class="src short"><a href="#v:getTxOutFromDB">getTxOutFromDB</a> :: (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m, MonadThrow m) =&gt; <a href="Pos-Types-Types.html#t:TxIn">TxIn</a> -&gt; <a href="Pos-DB.html#t:DB">DB</a> ssc -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Types-Types.html#t:TxOutAux">TxOutAux</a>)</li><li class="src short"><a href="#v:getTxOut">getTxOut</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Types.html#t:TxIn">TxIn</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Types-Types.html#t:TxOutAux">TxOutAux</a>)</li><li class="src short"><span class="keyword">data</span> <a href="#t:UtxoOp">UtxoOp</a><ul class="subs"><li>= <a href="#v:DelTxIn">DelTxIn</a> !<a href="Pos-Types-Types.html#t:TxIn">TxIn</a></li><li>| <a href="#v:AddTxOut">AddTxOut</a> !<a href="Pos-Types-Types.html#t:TxIn">TxIn</a> !<a href="Pos-Types-Types.html#t:TxOutAux">TxOutAux</a></li></ul></li><li class="src short"><a href="#v:prepareGStateUtxo">prepareGStateUtxo</a> :: <span class="keyword">forall</span> ssc m. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Types.html#t:Utxo">Utxo</a> -&gt; m ()</li><li class="src short"><span class="keyword">data</span> <a href="#t:UtxoIter">UtxoIter</a></li><li class="src short"><a href="#v:runUtxoIterator">runUtxoIterator</a> :: <span class="keyword">forall</span> m ssc a. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-DB.html#t:DBnIterator">DBnIterator</a> ssc <a href="Pos-DB-GState.html#t:UtxoIter">UtxoIter</a> a -&gt; m a</li><li class="src short"><a href="#v:runUtxoMapIterator">runUtxoMapIterator</a> :: <span class="keyword">forall</span> v m ssc a. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-DB.html#t:DBnMapIterator">DBnMapIterator</a> ssc <a href="Pos-DB-GState.html#t:UtxoIter">UtxoIter</a> v a -&gt; (<a href="Pos-DB.html#t:IterType">IterType</a> <a href="Pos-DB-GState.html#t:UtxoIter">UtxoIter</a> -&gt; v) -&gt; m a</li><li class="src short"><a href="#v:getFilteredUtxo">getFilteredUtxo</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Address.html#t:Address">Address</a> -&gt; m <a href="Pos-Types-Types.html#t:Utxo">Utxo</a></li><li class="src short"><a href="#v:sanityCheckUtxo">sanityCheckUtxo</a> :: (<a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m, WithLogger m) =&gt; <a href="Pos-Types.html#t:Coin">Coin</a> -&gt; m ()</li></ul></div><div id="interface"><h1 id="g:1">Getters</h1><div class="top"><p class="src"><a id="v:getTotalFtsStake" class="def">getTotalFtsStake</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m <a href="Pos-Types.html#t:Coin">Coin</a> <a href="src/Pos.DB.GState.Balances.html#getTotalFtsStake" class="link">Source</a> <a href="#v:getTotalFtsStake" class="selflink">#</a></p><div class="doc"><p>Get total amount of stake to be used for follow-the-satoshi. It's
 different from total amount of coins in the system.</p></div></div><div class="top"><p class="src"><a id="v:getFtsStake" class="def">getFtsStake</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Address.html#t:StakeholderId">StakeholderId</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Types.html#t:Coin">Coin</a>) <a href="src/Pos.DB.GState.Balances.html#getFtsStake" class="link">Source</a> <a href="#v:getFtsStake" class="selflink">#</a></p><div class="doc"><p>Get stake owne by given stakeholder (according to rules used for FTS).</p></div></div><div class="top"><p class="src"><a id="v:getFtsStakeFromDB" class="def">getFtsStakeFromDB</a> :: (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m, MonadThrow m) =&gt; <a href="Pos-Types-Address.html#t:StakeholderId">StakeholderId</a> -&gt; <a href="Pos-DB.html#t:DB">DB</a> ssc -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Types.html#t:Coin">Coin</a>) <a href="src/Pos.DB.GState.Balances.html#getFtsStakeFromDB" class="link">Source</a> <a href="#v:getFtsStakeFromDB" class="selflink">#</a></p></div><h1 id="g:2">Operations</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:BalancesOp" class="def">BalancesOp</a> <a href="src/Pos.DB.GState.Balances.html#BalancesOp" class="link">Source</a> <a href="#t:BalancesOp" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:PutFtsSum" class="def">PutFtsSum</a> !<a href="Pos-Types.html#t:Coin">Coin</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:PutFtsStake" class="def">PutFtsStake</a> !<a href="Pos-Types-Address.html#t:StakeholderId">StakeholderId</a> !<a href="Pos-Types.html#t:Coin">Coin</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:BalancesOp" class="caption collapser" onclick="toggleSection('i:BalancesOp')">Instances</p><div id="section.i:BalancesOp" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BalancesOp:Buildable:1" class="instance expander" onclick="toggleSection('i:id:BalancesOp:Buildable:1')"></span> Buildable <a href="Pos-DB-GState.html#t:BalancesOp">BalancesOp</a></span> <a href="src/Pos.DB.GState.Balances.html#line-80" class="link">Source</a> <a href="#t:BalancesOp" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:BalancesOp:Buildable:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:build">build</a> :: <a href="Pos-DB-GState.html#t:BalancesOp">BalancesOp</a> -&gt; Builder</p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BalancesOp:RocksBatchOp:2" class="instance expander" onclick="toggleSection('i:id:BalancesOp:RocksBatchOp:2')"></span> <a href="Pos-DB.html#t:RocksBatchOp">RocksBatchOp</a> <a href="Pos-DB-GState.html#t:BalancesOp">BalancesOp</a></span> <a href="src/Pos.DB.GState.Balances.html#line-85" class="link">Source</a> <a href="#t:BalancesOp" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:BalancesOp:RocksBatchOp:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toBatchOp">toBatchOp</a> :: <a href="Pos-DB-GState.html#t:BalancesOp">BalancesOp</a> -&gt; [BatchOp] <a href="src/Pos.DB.Functions.html#toBatchOp" class="link">Source</a> <a href="#v:toBatchOp" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><h1 id="g:3">Initialization</h1><div class="top"><p class="src"><a id="v:prepareGStateBalances" class="def">prepareGStateBalances</a> :: <span class="keyword">forall</span> ssc m. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Types.html#t:Utxo">Utxo</a> -&gt; m () <a href="src/Pos.DB.GState.Balances.html#prepareGStateBalances" class="link">Source</a> <a href="#v:prepareGStateBalances" class="selflink">#</a></p></div><h1 id="g:4">Iteration</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:BalIter" class="def">BalIter</a> <a href="src/Pos.DB.GState.Balances.html#BalIter" class="link">Source</a> <a href="#t:BalIter" class="selflink">#</a></p><div class="subs instances"><p id="control.i:BalIter" class="caption collapser" onclick="toggleSection('i:BalIter')">Instances</p><div id="section.i:BalIter" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BalIter:DBIteratorClass:1" class="instance expander" onclick="toggleSection('i:id:BalIter:DBIteratorClass:1')"></span> <a href="Pos-DB.html#t:DBIteratorClass">DBIteratorClass</a> <a href="Pos-DB-GState.html#t:BalIter">BalIter</a></span> <a href="src/Pos.DB.GState.Balances.html#line-122" class="link">Source</a> <a href="#t:BalIter" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:BalIter:DBIteratorClass:1" class="inst-details hide"><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterKey">IterKey</a> <a href="Pos-DB-GState.html#t:BalIter">BalIter</a> :: <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Kind.html#t:-42-">*</a> <a href="src/Pos.DB.Iterator.Class.html#IterKey" class="link">Source</a> <a href="#t:IterKey" class="selflink">#</a></p><p class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterValue">IterValue</a> <a href="Pos-DB-GState.html#t:BalIter">BalIter</a> :: <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Kind.html#t:-42-">*</a> <a href="src/Pos.DB.Iterator.Class.html#IterValue" class="link">Source</a> <a href="#t:IterValue" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:iterKeyPrefix">iterKeyPrefix</a> :: <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Proxy.html#t:Proxy">Proxy</a> <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Kind.html#t:-42-">*</a> <a href="Pos-DB-GState.html#t:BalIter">BalIter</a> -&gt; <a href="http://hackage.haskell.org/package/bytestring-0.10.8.1/docs/Data-ByteString.html#t:ByteString">ByteString</a> <a href="src/Pos.DB.Iterator.Class.html#iterKeyPrefix" class="link">Source</a> <a href="#v:iterKeyPrefix" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BalIter:IterKey:2" class="instance expander" onclick="toggleSection('i:id:BalIter:IterKey:2')"></span> <span class="keyword">type</span> <a href="Pos-DB.html#t:IterKey">IterKey</a> <a href="Pos-DB-GState.html#t:BalIter">BalIter</a></span> <a href="src/Pos.DB.GState.Balances.html#line-123" class="link">Source</a> <a href="#t:BalIter" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:BalIter:IterKey:2" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterKey">IterKey</a> <a href="Pos-DB-GState.html#t:BalIter">BalIter</a> = <a href="Pos-Types-Address.html#t:StakeholderId">StakeholderId</a></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BalIter:IterValue:3" class="instance expander" onclick="toggleSection('i:id:BalIter:IterValue:3')"></span> <span class="keyword">type</span> <a href="Pos-DB.html#t:IterValue">IterValue</a> <a href="Pos-DB-GState.html#t:BalIter">BalIter</a></span> <a href="src/Pos.DB.GState.Balances.html#line-124" class="link">Source</a> <a href="#t:BalIter" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:BalIter:IterValue:3" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterValue">IterValue</a> <a href="Pos-DB-GState.html#t:BalIter">BalIter</a> = <a href="Pos-Types.html#t:Coin">Coin</a></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><a id="v:runBalanceIterator" class="def">runBalanceIterator</a> :: <span class="keyword">forall</span> m ssc a. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-DB.html#t:DBnIterator">DBnIterator</a> ssc <a href="Pos-DB-GState.html#t:BalIter">BalIter</a> a -&gt; m a <a href="src/Pos.DB.GState.Balances.html#runBalanceIterator" class="link">Source</a> <a href="#v:runBalanceIterator" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:runBalanceMapIterator" class="def">runBalanceMapIterator</a> :: <span class="keyword">forall</span> v m ssc a. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-DB.html#t:DBnMapIterator">DBnMapIterator</a> ssc <a href="Pos-DB-GState.html#t:BalIter">BalIter</a> v a -&gt; (<a href="Pos-DB.html#t:IterType">IterType</a> <a href="Pos-DB-GState.html#t:BalIter">BalIter</a> -&gt; v) -&gt; m a <a href="src/Pos.DB.GState.Balances.html#runBalanceMapIterator" class="link">Source</a> <a href="#v:runBalanceMapIterator" class="selflink">#</a></p></div><h1 id="g:5">Sanity checks</h1><div class="top"><p class="src"><a id="v:sanityCheckBalances" class="def">sanityCheckBalances</a> :: (MonadMask m, <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m, WithLogger m) =&gt; m () <a href="src/Pos.DB.GState.Balances.html#sanityCheckBalances" class="link">Source</a> <a href="#v:sanityCheckBalances" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:resolveForwardLink" class="def">resolveForwardLink</a> :: (<a href="Pos-Types.html#t:HasHeaderHash">HasHeaderHash</a> a, <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m) =&gt; a -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a>) <a href="src/Pos.DB.GState.BlockExtra.html#resolveForwardLink" class="link">Source</a> <a href="#v:resolveForwardLink" class="selflink">#</a></p><div class="doc"><p>Tries to retrieve next block using current one (given a block/header).</p></div></div><div class="top"><p class="src"><a id="v:isBlockInMainChain" class="def">isBlockInMainChain</a> :: (<a href="Pos-Types.html#t:HasHeaderHash">HasHeaderHash</a> a, <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m) =&gt; a -&gt; m <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Bool.html#t:Bool">Bool</a> <a href="src/Pos.DB.GState.BlockExtra.html#isBlockInMainChain" class="link">Source</a> <a href="#v:isBlockInMainChain" class="selflink">#</a></p><div class="doc"><p>Check if given hash representing block is in main chain.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:BlockExtraOp" class="def">BlockExtraOp</a> <a href="src/Pos.DB.GState.BlockExtra.html#BlockExtraOp" class="link">Source</a> <a href="#t:BlockExtraOp" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:AddForwardLink" class="def">AddForwardLink</a> <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a> <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a></td><td class="doc"><p>Adds or overwrites forward link</p></td></tr><tr><td class="src"><a id="v:RemoveForwardLink" class="def">RemoveForwardLink</a> <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a></td><td class="doc"><p>Removes forward link</p></td></tr><tr><td class="src"><a id="v:SetInMainChain" class="def">SetInMainChain</a> <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Bool.html#t:Bool">Bool</a> <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a></td><td class="doc"><p>Enables or disables &quot;in main chain&quot; status of the block</p></td></tr></table></div><div class="subs instances"><p id="control.i:BlockExtraOp" class="caption collapser" onclick="toggleSection('i:BlockExtraOp')">Instances</p><div id="section.i:BlockExtraOp" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BlockExtraOp:Show:1" class="instance expander" onclick="toggleSection('i:id:BlockExtraOp:Show:1')"></span> <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Text-Show.html#t:Show">Show</a> <a href="Pos-DB-GState.html#t:BlockExtraOp">BlockExtraOp</a></span> <a href="src/Pos.DB.GState.BlockExtra.html#line-64" class="link">Source</a> <a href="#t:BlockExtraOp" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:BlockExtraOp:Show:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Pos-DB-GState.html#t:BlockExtraOp">BlockExtraOp</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Pos-DB-GState.html#t:BlockExtraOp">BlockExtraOp</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Pos-DB-GState.html#t:BlockExtraOp">BlockExtraOp</a>] -&gt; <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BlockExtraOp:Buildable:2" class="instance expander" onclick="toggleSection('i:id:BlockExtraOp:Buildable:2')"></span> Buildable <a href="Pos-DB-GState.html#t:BlockExtraOp">BlockExtraOp</a></span> <a href="src/Pos.DB.GState.BlockExtra.html#line-66" class="link">Source</a> <a href="#t:BlockExtraOp" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:BlockExtraOp:Buildable:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:build">build</a> :: <a href="Pos-DB-GState.html#t:BlockExtraOp">BlockExtraOp</a> -&gt; Builder</p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BlockExtraOp:RocksBatchOp:3" class="instance expander" onclick="toggleSection('i:id:BlockExtraOp:RocksBatchOp:3')"></span> <a href="Pos-DB.html#t:RocksBatchOp">RocksBatchOp</a> <a href="Pos-DB-GState.html#t:BlockExtraOp">BlockExtraOp</a></span> <a href="src/Pos.DB.GState.BlockExtra.html#line-74" class="link">Source</a> <a href="#t:BlockExtraOp" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:BlockExtraOp:RocksBatchOp:3" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toBatchOp">toBatchOp</a> :: <a href="Pos-DB-GState.html#t:BlockExtraOp">BlockExtraOp</a> -&gt; [BatchOp] <a href="src/Pos.DB.Functions.html#toBatchOp" class="link">Source</a> <a href="#v:toBatchOp" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><a id="v:loadHeadersUpWhile" class="def">loadHeadersUpWhile</a> :: (<a href="Pos-Ssc-Class.html#t:SscHelpersClass">SscHelpersClass</a> ssc, <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m, <a href="Pos-Types.html#t:HasHeaderHash">HasHeaderHash</a> a) =&gt; a -&gt; (<a href="Pos-Types-Block-Types.html#t:BlockHeader">BlockHeader</a> ssc -&gt; <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Bool.html#t:Bool">Bool</a>) -&gt; m (<a href="Pos-Util.html#t:OldestFirst">OldestFirst</a> [] (<a href="Pos-Types-Block-Types.html#t:BlockHeader">BlockHeader</a> ssc)) <a href="src/Pos.DB.GState.BlockExtra.html#loadHeadersUpWhile" class="link">Source</a> <a href="#v:loadHeadersUpWhile" class="selflink">#</a></p><div class="doc"><p>Returns headers loaded up.</p></div></div><div class="top"><p class="src"><a id="v:loadBlocksUpWhile" class="def">loadBlocksUpWhile</a> :: (<a href="Pos-Ssc-Class.html#t:SscHelpersClass">SscHelpersClass</a> ssc, <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m, <a href="Pos-Types.html#t:HasHeaderHash">HasHeaderHash</a> a) =&gt; a -&gt; (<a href="Pos-Types-Block-Types.html#t:Block">Block</a> ssc -&gt; <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Bool.html#t:Bool">Bool</a>) -&gt; m (<a href="Pos-Util.html#t:OldestFirst">OldestFirst</a> [] (<a href="Pos-Types-Block-Types.html#t:Block">Block</a> ssc)) <a href="src/Pos.DB.GState.BlockExtra.html#loadBlocksUpWhile" class="link">Source</a> <a href="#v:loadBlocksUpWhile" class="selflink">#</a></p><div class="doc"><p>Returns blocks loaded up.</p></div></div><div class="top"><p class="src"><a id="v:prepareGStateBlockExtra" class="def">prepareGStateBlockExtra</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a> -&gt; m () <a href="src/Pos.DB.GState.BlockExtra.html#prepareGStateBlockExtra" class="link">Source</a> <a href="#v:prepareGStateBlockExtra" class="selflink">#</a></p></div><h1 id="g:6">Getters</h1><div class="top"><p class="src"><a id="v:getTip" class="def">getTip</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a> <a href="src/Pos.DB.GState.Common.html#getTip" class="link">Source</a> <a href="#v:getTip" class="selflink">#</a></p><div class="doc"><p>Get current tip from GState DB.</p></div></div><div class="top"><p class="src"><a id="v:getBot" class="def">getBot</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a> <a href="src/Pos.DB.GState.Common.html#getBot" class="link">Source</a> <a href="#v:getBot" class="selflink">#</a></p><div class="doc"><p>Get the hash of the first genesis block from GState DB.</p></div></div><h1 id="g:7">Initialization</h1><div class="top"><p class="src"><a id="v:prepareGStateCommon" class="def">prepareGStateCommon</a> :: <span class="keyword">forall</span> ssc m. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a> -&gt; m () <a href="src/Pos.DB.GState.Common.html#prepareGStateCommon" class="link">Source</a> <a href="#v:prepareGStateCommon" class="selflink">#</a></p><div class="doc"><p>Put missing initial common data into GState DB.</p></div></div><h1 id="g:8">Helpers</h1><div class="top"><p class="src"><a id="v:getBi" class="def">getBi</a> :: (<a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m, <a href="Pos-Binary.html#t:Bi">Bi</a> v) =&gt; <a href="http://hackage.haskell.org/package/bytestring-0.10.8.1/docs/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> v) <a href="src/Pos.DB.GState.Common.html#getBi" class="link">Source</a> <a href="#v:getBi" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:putBi" class="def">putBi</a> :: (<a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m, <a href="Pos-Binary.html#t:Bi">Bi</a> v) =&gt; <a href="http://hackage.haskell.org/package/bytestring-0.10.8.1/docs/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; v -&gt; m () <a href="src/Pos.DB.GState.Common.html#putBi" class="link">Source</a> <a href="#v:putBi" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:delete" class="def">delete</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="http://hackage.haskell.org/package/bytestring-0.10.8.1/docs/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; m () <a href="src/Pos.DB.GState.Common.html#delete" class="link">Source</a> <a href="#v:delete" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:writeBatchGState" class="def">writeBatchGState</a> :: (<a href="Pos-DB.html#t:RocksBatchOp">RocksBatchOp</a> a, <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m) =&gt; [a] -&gt; m () <a href="src/Pos.DB.GState.Common.html#writeBatchGState" class="link">Source</a> <a href="#v:writeBatchGState" class="selflink">#</a></p></div><h1 id="g:9">Operations</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:CommonOp" class="def">CommonOp</a> <a href="src/Pos.DB.GState.Common.html#CommonOp" class="link">Source</a> <a href="#t:CommonOp" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:PutTip" class="def">PutTip</a> <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:CommonOp" class="caption collapser" onclick="toggleSection('i:CommonOp')">Instances</p><div id="section.i:CommonOp" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:CommonOp:Buildable:1" class="instance expander" onclick="toggleSection('i:id:CommonOp:Buildable:1')"></span> Buildable <a href="Pos-DB-GState.html#t:CommonOp">CommonOp</a></span> <a href="src/Pos.DB.GState.Common.html#line-77" class="link">Source</a> <a href="#t:CommonOp" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:CommonOp:Buildable:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:build">build</a> :: <a href="Pos-DB-GState.html#t:CommonOp">CommonOp</a> -&gt; Builder</p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:CommonOp:RocksBatchOp:2" class="instance expander" onclick="toggleSection('i:id:CommonOp:RocksBatchOp:2')"></span> <a href="Pos-DB.html#t:RocksBatchOp">RocksBatchOp</a> <a href="Pos-DB-GState.html#t:CommonOp">CommonOp</a></span> <a href="src/Pos.DB.GState.Common.html#line-80" class="link">Source</a> <a href="#t:CommonOp" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:CommonOp:RocksBatchOp:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toBatchOp">toBatchOp</a> :: <a href="Pos-DB-GState.html#t:CommonOp">CommonOp</a> -&gt; [BatchOp] <a href="src/Pos.DB.Functions.html#toBatchOp" class="link">Source</a> <a href="#v:toBatchOp" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><a id="v:getPSKByIssuerAddressHash" class="def">getPSKByIssuerAddressHash</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Address.html#t:StakeholderId">StakeholderId</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Types-Types.html#t:ProxySKHeavy">ProxySKHeavy</a>) <a href="src/Pos.DB.GState.Delegation.html#getPSKByIssuerAddressHash" class="link">Source</a> <a href="#v:getPSKByIssuerAddressHash" class="selflink">#</a></p><div class="doc"><p>Retrieves certificate by issuer address (hash of public key) if present.</p></div></div><div class="top"><p class="src"><a id="v:getPSKByIssuer" class="def">getPSKByIssuer</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Crypto.html#t:PublicKey">PublicKey</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Types-Types.html#t:ProxySKHeavy">ProxySKHeavy</a>) <a href="src/Pos.DB.GState.Delegation.html#getPSKByIssuer" class="link">Source</a> <a href="#v:getPSKByIssuer" class="selflink">#</a></p><div class="doc"><p>Retrieves certificate by issuer public key if present.</p></div></div><div class="top"><p class="src"><a id="v:isIssuerByAddressHash" class="def">isIssuerByAddressHash</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Address.html#t:StakeholderId">StakeholderId</a> -&gt; m <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Bool.html#t:Bool">Bool</a> <a href="src/Pos.DB.GState.Delegation.html#isIssuerByAddressHash" class="link">Source</a> <a href="#v:isIssuerByAddressHash" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:DelegationOp" class="def">DelegationOp</a> <a href="src/Pos.DB.GState.Delegation.html#DelegationOp" class="link">Source</a> <a href="#t:DelegationOp" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:AddPSK" class="def">AddPSK</a> !<a href="Pos-Types-Types.html#t:ProxySKHeavy">ProxySKHeavy</a></td><td class="doc"><p>Adds PSK. Overwrites if present.</p></td></tr><tr><td class="src"><a id="v:DelPSK" class="def">DelPSK</a> !<a href="Pos-Crypto.html#t:PublicKey">PublicKey</a></td><td class="doc"><p>Removes PSK by issuer PK.</p></td></tr></table></div><div class="subs instances"><p id="control.i:DelegationOp" class="caption collapser" onclick="toggleSection('i:DelegationOp')">Instances</p><div id="section.i:DelegationOp" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:DelegationOp:RocksBatchOp:1" class="instance expander" onclick="toggleSection('i:id:DelegationOp:RocksBatchOp:1')"></span> <a href="Pos-DB.html#t:RocksBatchOp">RocksBatchOp</a> <a href="Pos-DB-GState.html#t:DelegationOp">DelegationOp</a></span> <a href="src/Pos.DB.GState.Delegation.html#line-56" class="link">Source</a> <a href="#t:DelegationOp" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:DelegationOp:RocksBatchOp:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toBatchOp">toBatchOp</a> :: <a href="Pos-DB-GState.html#t:DelegationOp">DelegationOp</a> -&gt; [BatchOp] <a href="src/Pos.DB.Functions.html#toBatchOp" class="link">Source</a> <a href="#v:toBatchOp" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><a id="v:runPskIterator" class="def">runPskIterator</a> :: <span class="keyword">forall</span> m ssc a. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-DB.html#t:DBnIterator">DBnIterator</a> ssc PskIter a -&gt; m a <a href="src/Pos.DB.GState.Delegation.html#runPskIterator" class="link">Source</a> <a href="#v:runPskIterator" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:runPskMapIterator" class="def">runPskMapIterator</a> :: <span class="keyword">forall</span> v m ssc a. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-DB.html#t:DBnMapIterator">DBnMapIterator</a> ssc PskIter v a -&gt; (<a href="Pos-DB.html#t:IterType">IterType</a> PskIter -&gt; v) -&gt; m a <a href="src/Pos.DB.GState.Delegation.html#runPskMapIterator" class="link">Source</a> <a href="#v:runPskMapIterator" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:prepareGStateDB" class="def">prepareGStateDB</a> :: <span class="keyword">forall</span> ssc m. (<a href="Pos-Context.html#t:WithNodeContext">WithNodeContext</a> ssc m, <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m) =&gt; <a href="Pos-Types.html#t:HeaderHash">HeaderHash</a> -&gt; m () <a href="src/Pos.DB.GState.GState.html#prepareGStateDB" class="link">Source</a> <a href="#v:prepareGStateDB" class="selflink">#</a></p><div class="doc"><p>Put missing initial data into GState DB.</p></div></div><div class="top"><p class="src"><a id="v:sanityCheckGStateDB" class="def">sanityCheckGStateDB</a> :: <span class="keyword">forall</span> ssc m. (<a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m, MonadMask m, WithLogger m) =&gt; m () <a href="src/Pos.DB.GState.GState.html#sanityCheckGStateDB" class="link">Source</a> <a href="#v:sanityCheckGStateDB" class="selflink">#</a></p><div class="doc"><p>Check that GState DB is consistent.</p></div></div><div class="top"><p class="src"><a id="v:usingGStateSnapshot" class="def">usingGStateSnapshot</a> :: (<a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m, MonadMask m) =&gt; m a -&gt; m a <a href="src/Pos.DB.GState.GState.html#usingGStateSnapshot" class="link">Source</a> <a href="#v:usingGStateSnapshot" class="selflink">#</a></p></div><h1 id="g:10">Getters</h1><div class="top"><p class="src"><a id="v:getAdoptedBV" class="def">getAdoptedBV</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m <a href="Pos-Types-Version.html#t:BlockVersion">BlockVersion</a> <a href="src/Pos.DB.GState.Update.html#getAdoptedBV" class="link">Source</a> <a href="#v:getAdoptedBV" class="selflink">#</a></p><div class="doc"><p>Get last adopted block version.</p></div></div><div class="top"><p class="src"><a id="v:getAdoptedBVData" class="def">getAdoptedBVData</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m <a href="Pos-Update-Core.html#t:BlockVersionData">BlockVersionData</a> <a href="src/Pos.DB.GState.Update.html#getAdoptedBVData" class="link">Source</a> <a href="#v:getAdoptedBVData" class="selflink">#</a></p><div class="doc"><p>Get state of last adopted BlockVersion.</p></div></div><div class="top"><p class="src"><a id="v:getAdoptedBVFull" class="def">getAdoptedBVFull</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m (<a href="Pos-Types-Version.html#t:BlockVersion">BlockVersion</a>, <a href="Pos-Update-Core.html#t:BlockVersionData">BlockVersionData</a>) <a href="src/Pos.DB.GState.Update.html#getAdoptedBVFull" class="link">Source</a> <a href="#v:getAdoptedBVFull" class="selflink">#</a></p><div class="doc"><p>Get last adopted BlockVersion and data associated with it.</p></div></div><div class="top"><p class="src"><a id="v:getBVState" class="def">getBVState</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Version.html#t:BlockVersion">BlockVersion</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Update.html#t:BlockVersionState">BlockVersionState</a>) <a href="src/Pos.DB.GState.Update.html#getBVState" class="link">Source</a> <a href="#v:getBVState" class="selflink">#</a></p><div class="doc"><p>Get <code><a href="Pos-Update.html#t:BlockVersionState">BlockVersionState</a></code> associated with given BlockVersion.</p></div></div><div class="top"><p class="src"><a id="v:getProposalState" class="def">getProposalState</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Update-Core.html#t:UpId">UpId</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Update.html#t:ProposalState">ProposalState</a>) <a href="src/Pos.DB.GState.Update.html#getProposalState" class="link">Source</a> <a href="#v:getProposalState" class="selflink">#</a></p><div class="doc"><p>Get state of UpdateProposal for given UpId</p></div></div><div class="top"><p class="src"><a id="v:getAppProposal" class="def">getAppProposal</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Version.html#t:ApplicationName">ApplicationName</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Update-Core.html#t:UpId">UpId</a>) <a href="src/Pos.DB.GState.Update.html#getAppProposal" class="link">Source</a> <a href="#v:getAppProposal" class="selflink">#</a></p><div class="doc"><p>Get UpId of current proposal for given appName</p></div></div><div class="top"><p class="src"><a id="v:getProposalStateByApp" class="def">getProposalStateByApp</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Version.html#t:ApplicationName">ApplicationName</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Update.html#t:ProposalState">ProposalState</a>) <a href="src/Pos.DB.GState.Update.html#getProposalStateByApp" class="link">Source</a> <a href="#v:getProposalStateByApp" class="selflink">#</a></p><div class="doc"><p>Get state of Update Proposal for given AppName</p></div></div><div class="top"><p class="src"><a id="v:getConfirmedSV" class="def">getConfirmedSV</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Version.html#t:ApplicationName">ApplicationName</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Types-Version.html#t:NumSoftwareVersion">NumSoftwareVersion</a>) <a href="src/Pos.DB.GState.Update.html#getConfirmedSV" class="link">Source</a> <a href="#v:getConfirmedSV" class="selflink">#</a></p><div class="doc"><p>Get last confirmed SoftwareVersion of given application.</p></div></div><div class="top"><p class="src"><a id="v:getMaxBlockSize" class="def">getMaxBlockSize</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m Byte <a href="src/Pos.DB.GState.Update.html#getMaxBlockSize" class="link">Source</a> <a href="#v:getMaxBlockSize" class="selflink">#</a></p><div class="doc"><p>Get maximum block size (in bytes).</p></div></div><div class="top"><p class="src"><a id="v:getSlottingData" class="def">getSlottingData</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m <a href="Pos-Slotting.html#t:SlottingData">SlottingData</a> <a href="src/Pos.DB.GState.Update.html#getSlottingData" class="link">Source</a> <a href="#v:getSlottingData" class="selflink">#</a></p><div class="doc"><p>Get most recent <code><a href="Pos-Slotting.html#t:SlottingData">SlottingData</a></code>.</p></div></div><h1 id="g:11">Operations</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:UpdateOp" class="def">UpdateOp</a> <a href="src/Pos.DB.GState.Update.html#UpdateOp" class="link">Source</a> <a href="#t:UpdateOp" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:PutProposal" class="def">PutProposal</a> !<a href="Pos-Update.html#t:ProposalState">ProposalState</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:DeleteProposal" class="def">DeleteProposal</a> !<a href="Pos-Update-Core.html#t:UpId">UpId</a> !<a href="Pos-Types-Version.html#t:ApplicationName">ApplicationName</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:ConfirmVersion" class="def">ConfirmVersion</a> !<a href="Pos-Types-Version.html#t:SoftwareVersion">SoftwareVersion</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:DelConfirmedVersion" class="def">DelConfirmedVersion</a> !<a href="Pos-Types-Version.html#t:ApplicationName">ApplicationName</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:AddConfirmedProposal" class="def">AddConfirmedProposal</a> !<a href="Pos-Update.html#t:ConfirmedProposalState">ConfirmedProposalState</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:DelConfirmedProposal" class="def">DelConfirmedProposal</a> !<a href="Pos-Types-Version.html#t:SoftwareVersion">SoftwareVersion</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:SetAdopted" class="def">SetAdopted</a> !<a href="Pos-Types-Version.html#t:BlockVersion">BlockVersion</a> <a href="Pos-Update-Core.html#t:BlockVersionData">BlockVersionData</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:SetBVState" class="def">SetBVState</a> !<a href="Pos-Types-Version.html#t:BlockVersion">BlockVersion</a> !<a href="Pos-Update.html#t:BlockVersionState">BlockVersionState</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:DelBV" class="def">DelBV</a> !<a href="Pos-Types-Version.html#t:BlockVersion">BlockVersion</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:PutSlottingData" class="def">PutSlottingData</a> !<a href="Pos-Slotting.html#t:SlottingData">SlottingData</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:UpdateOp" class="caption collapser" onclick="toggleSection('i:UpdateOp')">Instances</p><div id="section.i:UpdateOp" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:UpdateOp:RocksBatchOp:1" class="instance expander" onclick="toggleSection('i:id:UpdateOp:RocksBatchOp:1')"></span> <a href="Pos-DB.html#t:RocksBatchOp">RocksBatchOp</a> <a href="Pos-DB-GState.html#t:UpdateOp">UpdateOp</a></span> <a href="src/Pos.DB.GState.Update.html#line-148" class="link">Source</a> <a href="#t:UpdateOp" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:UpdateOp:RocksBatchOp:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toBatchOp">toBatchOp</a> :: <a href="Pos-DB-GState.html#t:UpdateOp">UpdateOp</a> -&gt; [BatchOp] <a href="src/Pos.DB.Functions.html#toBatchOp" class="link">Source</a> <a href="#v:toBatchOp" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><h1 id="g:12">Initialization</h1><div class="top"><p class="src"><a id="v:prepareGStateUS" class="def">prepareGStateUS</a> :: <span class="keyword">forall</span> ssc m. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Timestamp.html#t:Timestamp">Timestamp</a> -&gt; m () <a href="src/Pos.DB.GState.Update.html#prepareGStateUS" class="link">Source</a> <a href="#v:prepareGStateUS" class="selflink">#</a></p></div><h1 id="g:13">Iteration</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:PropIter" class="def">PropIter</a> <a href="src/Pos.DB.GState.Update.html#PropIter" class="link">Source</a> <a href="#t:PropIter" class="selflink">#</a></p><div class="subs instances"><p id="control.i:PropIter" class="caption collapser" onclick="toggleSection('i:PropIter')">Instances</p><div id="section.i:PropIter" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:PropIter:DBIteratorClass:1" class="instance expander" onclick="toggleSection('i:id:PropIter:DBIteratorClass:1')"></span> <a href="Pos-DB.html#t:DBIteratorClass">DBIteratorClass</a> <a href="Pos-DB-GState.html#t:PropIter">PropIter</a></span> <a href="src/Pos.DB.GState.Update.html#line-211" class="link">Source</a> <a href="#t:PropIter" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:PropIter:DBIteratorClass:1" class="inst-details hide"><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterKey">IterKey</a> <a href="Pos-DB-GState.html#t:PropIter">PropIter</a> :: <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Kind.html#t:-42-">*</a> <a href="src/Pos.DB.Iterator.Class.html#IterKey" class="link">Source</a> <a href="#t:IterKey" class="selflink">#</a></p><p class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterValue">IterValue</a> <a href="Pos-DB-GState.html#t:PropIter">PropIter</a> :: <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Kind.html#t:-42-">*</a> <a href="src/Pos.DB.Iterator.Class.html#IterValue" class="link">Source</a> <a href="#t:IterValue" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:iterKeyPrefix">iterKeyPrefix</a> :: <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Proxy.html#t:Proxy">Proxy</a> <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Kind.html#t:-42-">*</a> <a href="Pos-DB-GState.html#t:PropIter">PropIter</a> -&gt; <a href="http://hackage.haskell.org/package/bytestring-0.10.8.1/docs/Data-ByteString.html#t:ByteString">ByteString</a> <a href="src/Pos.DB.Iterator.Class.html#iterKeyPrefix" class="link">Source</a> <a href="#v:iterKeyPrefix" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:PropIter:IterKey:2" class="instance expander" onclick="toggleSection('i:id:PropIter:IterKey:2')"></span> <span class="keyword">type</span> <a href="Pos-DB.html#t:IterKey">IterKey</a> <a href="Pos-DB-GState.html#t:PropIter">PropIter</a></span> <a href="src/Pos.DB.GState.Update.html#line-212" class="link">Source</a> <a href="#t:PropIter" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:PropIter:IterKey:2" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterKey">IterKey</a> <a href="Pos-DB-GState.html#t:PropIter">PropIter</a> = <a href="Pos-Update-Core.html#t:UpId">UpId</a></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:PropIter:IterValue:3" class="instance expander" onclick="toggleSection('i:id:PropIter:IterValue:3')"></span> <span class="keyword">type</span> <a href="Pos-DB.html#t:IterValue">IterValue</a> <a href="Pos-DB-GState.html#t:PropIter">PropIter</a></span> <a href="src/Pos.DB.GState.Update.html#line-213" class="link">Source</a> <a href="#t:PropIter" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:PropIter:IterValue:3" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterValue">IterValue</a> <a href="Pos-DB-GState.html#t:PropIter">PropIter</a> = <a href="Pos-Update.html#t:ProposalState">ProposalState</a></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><a id="v:runProposalMapIterator" class="def">runProposalMapIterator</a> :: <span class="keyword">forall</span> v m ssc a. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-DB.html#t:DBnMapIterator">DBnMapIterator</a> ssc <a href="Pos-DB-GState.html#t:PropIter">PropIter</a> v a -&gt; (<a href="Pos-DB.html#t:IterType">IterType</a> <a href="Pos-DB-GState.html#t:PropIter">PropIter</a> -&gt; v) -&gt; m a <a href="src/Pos.DB.GState.Update.html#runProposalMapIterator" class="link">Source</a> <a href="#v:runProposalMapIterator" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:runProposalIterator" class="def">runProposalIterator</a> :: <span class="keyword">forall</span> m ssc a. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-DB.html#t:DBnIterator">DBnIterator</a> ssc <a href="Pos-DB-GState.html#t:PropIter">PropIter</a> a -&gt; m a <a href="src/Pos.DB.GState.Update.html#runProposalIterator" class="link">Source</a> <a href="#v:runProposalIterator" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getOldProposals" class="def">getOldProposals</a> :: <span class="keyword">forall</span> ssc m. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types.html#t:SlotId">SlotId</a> -&gt; m [<a href="Pos-Update.html#t:UndecidedProposalState">UndecidedProposalState</a>] <a href="src/Pos.DB.GState.Update.html#getOldProposals" class="link">Source</a> <a href="#v:getOldProposals" class="selflink">#</a></p><div class="doc"><p>Get all proposals which were issued no later than given slot.</p></div></div><div class="top"><p class="src"><a id="v:getDeepProposals" class="def">getDeepProposals</a> :: <span class="keyword">forall</span> ssc m. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types.html#t:ChainDifficulty">ChainDifficulty</a> -&gt; m [<a href="Pos-Update.html#t:DecidedProposalState">DecidedProposalState</a>] <a href="src/Pos.DB.GState.Update.html#getDeepProposals" class="link">Source</a> <a href="#v:getDeepProposals" class="selflink">#</a></p><div class="doc"><p>Get all decided proposals which were accepted deeper than given
 difficulty.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ConfPropIter" class="def">ConfPropIter</a> <a href="src/Pos.DB.GState.Update.html#ConfPropIter" class="link">Source</a> <a href="#t:ConfPropIter" class="selflink">#</a></p><div class="subs instances"><p id="control.i:ConfPropIter" class="caption collapser" onclick="toggleSection('i:ConfPropIter')">Instances</p><div id="section.i:ConfPropIter" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:ConfPropIter:DBIteratorClass:1" class="instance expander" onclick="toggleSection('i:id:ConfPropIter:DBIteratorClass:1')"></span> <a href="Pos-DB.html#t:DBIteratorClass">DBIteratorClass</a> <a href="Pos-DB-GState.html#t:ConfPropIter">ConfPropIter</a></span> <a href="src/Pos.DB.GState.Update.html#line-260" class="link">Source</a> <a href="#t:ConfPropIter" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:ConfPropIter:DBIteratorClass:1" class="inst-details hide"><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterKey">IterKey</a> <a href="Pos-DB-GState.html#t:ConfPropIter">ConfPropIter</a> :: <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Kind.html#t:-42-">*</a> <a href="src/Pos.DB.Iterator.Class.html#IterKey" class="link">Source</a> <a href="#t:IterKey" class="selflink">#</a></p><p class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterValue">IterValue</a> <a href="Pos-DB-GState.html#t:ConfPropIter">ConfPropIter</a> :: <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Kind.html#t:-42-">*</a> <a href="src/Pos.DB.Iterator.Class.html#IterValue" class="link">Source</a> <a href="#t:IterValue" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:iterKeyPrefix">iterKeyPrefix</a> :: <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Proxy.html#t:Proxy">Proxy</a> <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Kind.html#t:-42-">*</a> <a href="Pos-DB-GState.html#t:ConfPropIter">ConfPropIter</a> -&gt; <a href="http://hackage.haskell.org/package/bytestring-0.10.8.1/docs/Data-ByteString.html#t:ByteString">ByteString</a> <a href="src/Pos.DB.Iterator.Class.html#iterKeyPrefix" class="link">Source</a> <a href="#v:iterKeyPrefix" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:ConfPropIter:IterKey:2" class="instance expander" onclick="toggleSection('i:id:ConfPropIter:IterKey:2')"></span> <span class="keyword">type</span> <a href="Pos-DB.html#t:IterKey">IterKey</a> <a href="Pos-DB-GState.html#t:ConfPropIter">ConfPropIter</a></span> <a href="src/Pos.DB.GState.Update.html#line-261" class="link">Source</a> <a href="#t:ConfPropIter" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:ConfPropIter:IterKey:2" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterKey">IterKey</a> <a href="Pos-DB-GState.html#t:ConfPropIter">ConfPropIter</a> = <a href="Pos-Types-Version.html#t:SoftwareVersion">SoftwareVersion</a></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:ConfPropIter:IterValue:3" class="instance expander" onclick="toggleSection('i:id:ConfPropIter:IterValue:3')"></span> <span class="keyword">type</span> <a href="Pos-DB.html#t:IterValue">IterValue</a> <a href="Pos-DB-GState.html#t:ConfPropIter">ConfPropIter</a></span> <a href="src/Pos.DB.GState.Update.html#line-262" class="link">Source</a> <a href="#t:ConfPropIter" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:ConfPropIter:IterValue:3" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterValue">IterValue</a> <a href="Pos-DB-GState.html#t:ConfPropIter">ConfPropIter</a> = <a href="Pos-Update.html#t:ConfirmedProposalState">ConfirmedProposalState</a></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><a id="v:getConfirmedProposals" class="def">getConfirmedProposals</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Types-Version.html#t:NumSoftwareVersion">NumSoftwareVersion</a> -&gt; m [<a href="Pos-Update.html#t:ConfirmedProposalState">ConfirmedProposalState</a>] <a href="src/Pos.DB.GState.Update.html#getConfirmedProposals" class="link">Source</a> <a href="#v:getConfirmedProposals" class="selflink">#</a></p><div class="doc"><p>Get confirmed proposals which update our application and have
 version bigger than argument (or all proposals if <code><a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#v:Nothing">Nothing</a></code> is
 passed). For instance, current software version can be passed to
 this function to get all proposals with bigger version.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:BVIter" class="def">BVIter</a> <a href="src/Pos.DB.GState.Update.html#BVIter" class="link">Source</a> <a href="#t:BVIter" class="selflink">#</a></p><div class="subs instances"><p id="control.i:BVIter" class="caption collapser" onclick="toggleSection('i:BVIter')">Instances</p><div id="section.i:BVIter" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BVIter:DBIteratorClass:1" class="instance expander" onclick="toggleSection('i:id:BVIter:DBIteratorClass:1')"></span> <a href="Pos-DB.html#t:DBIteratorClass">DBIteratorClass</a> <a href="Pos-DB-GState.html#t:BVIter">BVIter</a></span> <a href="src/Pos.DB.GState.Update.html#line-286" class="link">Source</a> <a href="#t:BVIter" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:BVIter:DBIteratorClass:1" class="inst-details hide"><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterKey">IterKey</a> <a href="Pos-DB-GState.html#t:BVIter">BVIter</a> :: <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Kind.html#t:-42-">*</a> <a href="src/Pos.DB.Iterator.Class.html#IterKey" class="link">Source</a> <a href="#t:IterKey" class="selflink">#</a></p><p class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterValue">IterValue</a> <a href="Pos-DB-GState.html#t:BVIter">BVIter</a> :: <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Kind.html#t:-42-">*</a> <a href="src/Pos.DB.Iterator.Class.html#IterValue" class="link">Source</a> <a href="#t:IterValue" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:iterKeyPrefix">iterKeyPrefix</a> :: <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Proxy.html#t:Proxy">Proxy</a> <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Kind.html#t:-42-">*</a> <a href="Pos-DB-GState.html#t:BVIter">BVIter</a> -&gt; <a href="http://hackage.haskell.org/package/bytestring-0.10.8.1/docs/Data-ByteString.html#t:ByteString">ByteString</a> <a href="src/Pos.DB.Iterator.Class.html#iterKeyPrefix" class="link">Source</a> <a href="#v:iterKeyPrefix" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BVIter:IterKey:2" class="instance expander" onclick="toggleSection('i:id:BVIter:IterKey:2')"></span> <span class="keyword">type</span> <a href="Pos-DB.html#t:IterKey">IterKey</a> <a href="Pos-DB-GState.html#t:BVIter">BVIter</a></span> <a href="src/Pos.DB.GState.Update.html#line-287" class="link">Source</a> <a href="#t:BVIter" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:BVIter:IterKey:2" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterKey">IterKey</a> <a href="Pos-DB-GState.html#t:BVIter">BVIter</a> = <a href="Pos-Types-Version.html#t:BlockVersion">BlockVersion</a></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BVIter:IterValue:3" class="instance expander" onclick="toggleSection('i:id:BVIter:IterValue:3')"></span> <span class="keyword">type</span> <a href="Pos-DB.html#t:IterValue">IterValue</a> <a href="Pos-DB-GState.html#t:BVIter">BVIter</a></span> <a href="src/Pos.DB.GState.Update.html#line-288" class="link">Source</a> <a href="#t:BVIter" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:BVIter:IterValue:3" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterValue">IterValue</a> <a href="Pos-DB-GState.html#t:BVIter">BVIter</a> = <a href="Pos-Update.html#t:BlockVersionState">BlockVersionState</a></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><a id="v:getProposedBVs" class="def">getProposedBVs</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m [<a href="Pos-Types-Version.html#t:BlockVersion">BlockVersion</a>] <a href="src/Pos.DB.GState.Update.html#getProposedBVs" class="link">Source</a> <a href="#v:getProposedBVs" class="selflink">#</a></p><div class="doc"><p>Get all proposed <code><a href="Pos-Types-Version.html#t:BlockVersion">BlockVersion</a></code>s.</p></div></div><div class="top"><p class="src"><a id="v:getConfirmedBVStates" class="def">getConfirmedBVStates</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m [(<a href="Pos-Types-Version.html#t:BlockVersion">BlockVersion</a>, <a href="Pos-Update.html#t:BlockVersionState">BlockVersionState</a>)] <a href="src/Pos.DB.GState.Update.html#getConfirmedBVStates" class="link">Source</a> <a href="#v:getConfirmedBVStates" class="selflink">#</a></p><div class="doc"><p>Get all confirmed <code><a href="Pos-Types-Version.html#t:BlockVersion">BlockVersion</a></code>s and their states.</p></div></div><div class="top"><p class="src"><a id="v:getProposedBVStates" class="def">getProposedBVStates</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; m [<a href="Pos-Update.html#t:BlockVersionState">BlockVersionState</a>] <a href="src/Pos.DB.GState.Update.html#getProposedBVStates" class="link">Source</a> <a href="#v:getProposedBVStates" class="selflink">#</a></p></div><h1 id="g:14">Getters</h1><div class="top"><p class="src"><a id="v:getGenUtxo" class="def">getGenUtxo</a> :: (MonadThrow m, <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m) =&gt; m <a href="Pos-Types-Types.html#t:Utxo">Utxo</a> <a href="src/Pos.DB.GState.Utxo.html#getGenUtxo" class="link">Source</a> <a href="#v:getGenUtxo" class="selflink">#</a></p><div class="doc"><p>Get genesis utxo</p></div></div><div class="top"><p class="src"><a id="v:getTxOutFromDB" class="def">getTxOutFromDB</a> :: (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m, MonadThrow m) =&gt; <a href="Pos-Types-Types.html#t:TxIn">TxIn</a> -&gt; <a href="Pos-DB.html#t:DB">DB</a> ssc -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Types-Types.html#t:TxOutAux">TxOutAux</a>) <a href="src/Pos.DB.GState.Utxo.html#getTxOutFromDB" class="link">Source</a> <a href="#v:getTxOutFromDB" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getTxOut" class="def">getTxOut</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Types.html#t:TxIn">TxIn</a> -&gt; m (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Types-Types.html#t:TxOutAux">TxOutAux</a>) <a href="src/Pos.DB.GState.Utxo.html#getTxOut" class="link">Source</a> <a href="#v:getTxOut" class="selflink">#</a></p></div><h1 id="g:15">Operations</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:UtxoOp" class="def">UtxoOp</a> <a href="src/Pos.DB.GState.Utxo.html#UtxoOp" class="link">Source</a> <a href="#t:UtxoOp" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:DelTxIn" class="def">DelTxIn</a> !<a href="Pos-Types-Types.html#t:TxIn">TxIn</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:AddTxOut" class="def">AddTxOut</a> !<a href="Pos-Types-Types.html#t:TxIn">TxIn</a> !<a href="Pos-Types-Types.html#t:TxOutAux">TxOutAux</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:UtxoOp" class="caption collapser" onclick="toggleSection('i:UtxoOp')">Instances</p><div id="section.i:UtxoOp" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:UtxoOp:Buildable:1" class="instance expander" onclick="toggleSection('i:id:UtxoOp:Buildable:1')"></span> Buildable <a href="Pos-DB-GState.html#t:UtxoOp">UtxoOp</a></span> <a href="src/Pos.DB.GState.Utxo.html#line-76" class="link">Source</a> <a href="#t:UtxoOp" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:UtxoOp:Buildable:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:build">build</a> :: <a href="Pos-DB-GState.html#t:UtxoOp">UtxoOp</a> -&gt; Builder</p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:UtxoOp:RocksBatchOp:2" class="instance expander" onclick="toggleSection('i:id:UtxoOp:RocksBatchOp:2')"></span> <a href="Pos-DB.html#t:RocksBatchOp">RocksBatchOp</a> <a href="Pos-DB-GState.html#t:UtxoOp">UtxoOp</a></span> <a href="src/Pos.DB.GState.Utxo.html#line-83" class="link">Source</a> <a href="#t:UtxoOp" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:UtxoOp:RocksBatchOp:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toBatchOp">toBatchOp</a> :: <a href="Pos-DB-GState.html#t:UtxoOp">UtxoOp</a> -&gt; [BatchOp] <a href="src/Pos.DB.Functions.html#toBatchOp" class="link">Source</a> <a href="#v:toBatchOp" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><h1 id="g:16">Initialization</h1><div class="top"><p class="src"><a id="v:prepareGStateUtxo" class="def">prepareGStateUtxo</a> :: <span class="keyword">forall</span> ssc m. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Types.html#t:Utxo">Utxo</a> -&gt; m () <a href="src/Pos.DB.GState.Utxo.html#prepareGStateUtxo" class="link">Source</a> <a href="#v:prepareGStateUtxo" class="selflink">#</a></p></div><h1 id="g:17">Iteration</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:UtxoIter" class="def">UtxoIter</a> <a href="src/Pos.DB.GState.Utxo.html#UtxoIter" class="link">Source</a> <a href="#t:UtxoIter" class="selflink">#</a></p><div class="subs instances"><p id="control.i:UtxoIter" class="caption collapser" onclick="toggleSection('i:UtxoIter')">Instances</p><div id="section.i:UtxoIter" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:UtxoIter:DBIteratorClass:1" class="instance expander" onclick="toggleSection('i:id:UtxoIter:DBIteratorClass:1')"></span> <a href="Pos-DB.html#t:DBIteratorClass">DBIteratorClass</a> <a href="Pos-DB-GState.html#t:UtxoIter">UtxoIter</a></span> <a href="src/Pos.DB.GState.Utxo.html#line-118" class="link">Source</a> <a href="#t:UtxoIter" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:UtxoIter:DBIteratorClass:1" class="inst-details hide"><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterKey">IterKey</a> <a href="Pos-DB-GState.html#t:UtxoIter">UtxoIter</a> :: <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Kind.html#t:-42-">*</a> <a href="src/Pos.DB.Iterator.Class.html#IterKey" class="link">Source</a> <a href="#t:IterKey" class="selflink">#</a></p><p class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterValue">IterValue</a> <a href="Pos-DB-GState.html#t:UtxoIter">UtxoIter</a> :: <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Kind.html#t:-42-">*</a> <a href="src/Pos.DB.Iterator.Class.html#IterValue" class="link">Source</a> <a href="#t:IterValue" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:iterKeyPrefix">iterKeyPrefix</a> :: <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Proxy.html#t:Proxy">Proxy</a> <a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Kind.html#t:-42-">*</a> <a href="Pos-DB-GState.html#t:UtxoIter">UtxoIter</a> -&gt; <a href="http://hackage.haskell.org/package/bytestring-0.10.8.1/docs/Data-ByteString.html#t:ByteString">ByteString</a> <a href="src/Pos.DB.Iterator.Class.html#iterKeyPrefix" class="link">Source</a> <a href="#v:iterKeyPrefix" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:UtxoIter:IterKey:2" class="instance expander" onclick="toggleSection('i:id:UtxoIter:IterKey:2')"></span> <span class="keyword">type</span> <a href="Pos-DB.html#t:IterKey">IterKey</a> <a href="Pos-DB-GState.html#t:UtxoIter">UtxoIter</a></span> <a href="src/Pos.DB.GState.Utxo.html#line-119" class="link">Source</a> <a href="#t:UtxoIter" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:UtxoIter:IterKey:2" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterKey">IterKey</a> <a href="Pos-DB-GState.html#t:UtxoIter">UtxoIter</a> = <a href="Pos-Types-Types.html#t:TxIn">TxIn</a></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:UtxoIter:IterValue:3" class="instance expander" onclick="toggleSection('i:id:UtxoIter:IterValue:3')"></span> <span class="keyword">type</span> <a href="Pos-DB.html#t:IterValue">IterValue</a> <a href="Pos-DB-GState.html#t:UtxoIter">UtxoIter</a></span> <a href="src/Pos.DB.GState.Utxo.html#line-120" class="link">Source</a> <a href="#t:UtxoIter" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:UtxoIter:IterValue:3" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="Pos-DB.html#t:IterValue">IterValue</a> <a href="Pos-DB-GState.html#t:UtxoIter">UtxoIter</a> = <a href="Pos-Types-Types.html#t:TxOutAux">TxOutAux</a></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><a id="v:runUtxoIterator" class="def">runUtxoIterator</a> :: <span class="keyword">forall</span> m ssc a. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-DB.html#t:DBnIterator">DBnIterator</a> ssc <a href="Pos-DB-GState.html#t:UtxoIter">UtxoIter</a> a -&gt; m a <a href="src/Pos.DB.GState.Utxo.html#runUtxoIterator" class="link">Source</a> <a href="#v:runUtxoIterator" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:runUtxoMapIterator" class="def">runUtxoMapIterator</a> :: <span class="keyword">forall</span> v m ssc a. <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-DB.html#t:DBnMapIterator">DBnMapIterator</a> ssc <a href="Pos-DB-GState.html#t:UtxoIter">UtxoIter</a> v a -&gt; (<a href="Pos-DB.html#t:IterType">IterType</a> <a href="Pos-DB-GState.html#t:UtxoIter">UtxoIter</a> -&gt; v) -&gt; m a <a href="src/Pos.DB.GState.Utxo.html#runUtxoMapIterator" class="link">Source</a> <a href="#v:runUtxoMapIterator" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getFilteredUtxo" class="def">getFilteredUtxo</a> :: <a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m =&gt; <a href="Pos-Types-Address.html#t:Address">Address</a> -&gt; m <a href="Pos-Types-Types.html#t:Utxo">Utxo</a> <a href="src/Pos.DB.GState.Utxo.html#getFilteredUtxo" class="link">Source</a> <a href="#v:getFilteredUtxo" class="selflink">#</a></p><div class="doc"><p>Get small sub-utxo containing only outputs of given address</p></div></div><h1 id="g:18">Sanity checks</h1><div class="top"><p class="src"><a id="v:sanityCheckUtxo" class="def">sanityCheckUtxo</a> :: (<a href="Pos-DB.html#t:MonadDB">MonadDB</a> ssc m, WithLogger m) =&gt; <a href="Pos-Types.html#t:Coin">Coin</a> -&gt; m () <a href="src/Pos.DB.GState.Utxo.html#sanityCheckUtxo" class="link">Source</a> <a href="#v:sanityCheckUtxo" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.3</p></div></body></html>
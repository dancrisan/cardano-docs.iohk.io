<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><a name="line-2"></a><span class="hs-comment">-- | `Arbitrary` instances for using in tests and benchmarks</span><span>
</span><a name="line-3"></a><span>
</span><a name="line-4"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">Arbitrary</span><span>
</span><a name="line-5"></a><span>       </span><span class="hs-special">(</span><span>
</span><a name="line-6"></a><span>       </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span class="hs-operator">.</span><span class="hs-identifier">NonEmpty</span><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromList</span><span class="hs-special">)</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span class="hs-operator">.</span><span class="hs-identifier">Unsafe</span><span>            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unsafePerformIO</span><span class="hs-special">)</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Test</span><span class="hs-operator">.</span><span class="hs-identifier">QuickCheck</span><span>             </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">choose</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">elements</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">generate</span><span class="hs-special">)</span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Universum</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Binary</span><span class="hs-operator">.</span><span class="hs-identifier">Class</span><span>            </span><span class="hs-special">(</span><span class="hs-identifier hs-type">AsBinary</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">AsBinaryClass</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bi</span><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Binary</span><span class="hs-operator">.</span><span class="hs-identifier">Crypto</span><span>           </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Crypto.Arbitrary.Unsafe.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">Arbitrary</span><span class="hs-operator">.</span><span class="hs-identifier">Unsafe</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">AsBinary</span><span>         </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">Hashing</span><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-type">AbstractHash</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">HashAlgorithm</span><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">SecretSharing</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">EncShare</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Secret</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">SecretProof</span><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>                                              </span><span class="hs-identifier hs-type">SecretSharingExtra</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Share</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">VssKeyPair</span><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>                                              </span><span class="hs-identifier hs-type">VssPublicKey</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">decryptShare</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">genSharedSecret</span><span class="hs-special">,</span><span>
</span><a name="line-21"></a><span>                                              </span><span class="hs-identifier hs-var">toVssPublicKey</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">vssKeyGen</span><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">Signing</span><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ProxyCert</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ProxySecretKey</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ProxySignature</span><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>                                              </span><span class="hs-identifier hs-type">PublicKey</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">SecretKey</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Signature</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Signed</span><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>                                              </span><span class="hs-identifier hs-var">createProxyCert</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">createProxySecretKey</span><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>                                              </span><span class="hs-identifier hs-var">keyGen</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mkSigned</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">proxySign</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">sign</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">toPublic</span><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">RedeemSigning</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">RedeemPublicKey</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RedeemSecretKey</span><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>                                              </span><span class="hs-identifier hs-type">RedeemSignature</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">redeemKeyGen</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">redeemSign</span><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Util.Arbitrary.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Util</span><span class="hs-operator">.</span><span class="hs-identifier">Arbitrary</span></a><span>          </span><span class="hs-special">(</span><a href="Pos.Util.Arbitrary.html#Nonrepeating"><span class="hs-identifier hs-type">Nonrepeating</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Pos.Util.Arbitrary.html#arbitraryUnsafe"><span class="hs-identifier hs-var">arbitraryUnsafe</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>                                              </span><a href="Pos.Util.Arbitrary.html#sublistN"><span class="hs-identifier hs-var">sublistN</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Util.Arbitrary.html#unsafeMakePool"><span class="hs-identifier hs-var">unsafeMakePool</span></a><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-comment">{- A note on 'Arbitrary' instances
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

We can't make an 'Arbitrary' instance for keys or seeds because generating
them safely requires randomness which must come from IO (we could use an
'arbitrary' randomness generator for an 'Arbitrary' instance, but then what's
the point of testing key generation when we use different generators in
production and in tests?). So, we just generate lots of keys and seeds with
'unsafePerformIO' and use them for everything.
-}</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-43"></a><span class="hs-comment">-- Arbitrary signing keys</span><span>
</span><a name="line-44"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-comment">-- If you want an arbitrary keypair, just generate a secret key with</span><span>
</span><a name="line-47"></a><span class="hs-comment">-- 'arbitrary' and then use 'Pos.Crypto.toPublic' to get the corresponding</span><span>
</span><a name="line-48"></a><span class="hs-comment">-- public key.</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-identifier">keys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">PublicKey</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">SecretKey</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-51"></a><a name="keys"><a href="Pos.Crypto.Arbitrary.html#keys"><span class="hs-identifier">keys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Util.Arbitrary.html#unsafeMakePool"><span class="hs-identifier hs-var">unsafeMakePool</span></a><span> </span><span class="hs-string">&quot;[generating keys for tests...]&quot;</span><span> </span><span class="hs-number">50</span><span> </span><span class="hs-identifier hs-var">keyGen</span><span>
</span><a name="line-52"></a><span class="hs-pragma">{-# NOINLINE keys #-}</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-identifier hs-type">PublicKey</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-55"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">elements</span><span> </span><a href="Pos.Crypto.Arbitrary.html#keys"><span class="hs-identifier hs-var">keys</span></a><span>
</span><a name="line-56"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-identifier hs-type">SecretKey</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-57"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">elements</span><span> </span><a href="Pos.Crypto.Arbitrary.html#keys"><span class="hs-identifier hs-var">keys</span></a><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-keyword">instance</span><span> </span><a href="Pos.Util.Arbitrary.html#Nonrepeating"><span class="hs-identifier hs-type">Nonrepeating</span></a><span> </span><span class="hs-identifier hs-type">PublicKey</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-60"></a><span>    </span><a name="local-8214565720323932775"><a href="Pos.Util.Arbitrary.html#nonrepeating"><span class="hs-identifier">nonrepeating</span></a></a><span> </span><a name="local-6989586621679528330"><a href="#local-6989586621679528330"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Pos.Util.Arbitrary.html#sublistN"><span class="hs-identifier hs-var">sublistN</span></a><span> </span><a href="#local-6989586621679528330"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="Pos.Crypto.Arbitrary.html#keys"><span class="hs-identifier hs-var">keys</span></a><span>
</span><a name="line-61"></a><span class="hs-keyword">instance</span><span> </span><a href="Pos.Util.Arbitrary.html#Nonrepeating"><span class="hs-identifier hs-type">Nonrepeating</span></a><span> </span><span class="hs-identifier hs-type">SecretKey</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-62"></a><span>    </span><a name="local-8214565720323932775"><a href="Pos.Util.Arbitrary.html#nonrepeating"><span class="hs-identifier">nonrepeating</span></a></a><span> </span><a name="local-6989586621679528329"><a href="#local-6989586621679528329"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Pos.Util.Arbitrary.html#sublistN"><span class="hs-identifier hs-var">sublistN</span></a><span> </span><a href="#local-6989586621679528329"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="Pos.Crypto.Arbitrary.html#keys"><span class="hs-identifier hs-var">keys</span></a><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-comment">-- Repeat the same for ADA redemption keys</span><span>
</span><a name="line-65"></a><span class="hs-identifier">redemptionKeys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">RedeemPublicKey</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RedeemSecretKey</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-66"></a><a name="redemptionKeys"><a href="Pos.Crypto.Arbitrary.html#redemptionKeys"><span class="hs-identifier">redemptionKeys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Util.Arbitrary.html#unsafeMakePool"><span class="hs-identifier hs-var">unsafeMakePool</span></a><span> </span><span class="hs-string">&quot;[generating redemption keys for tests..]&quot;</span><span> </span><span class="hs-number">50</span><span> </span><span class="hs-identifier hs-var">redeemKeyGen</span><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-identifier hs-type">RedeemPublicKey</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-69"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">elements</span><span> </span><a href="Pos.Crypto.Arbitrary.html#redemptionKeys"><span class="hs-identifier hs-var">redemptionKeys</span></a><span>
</span><a name="line-70"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-identifier hs-type">RedeemSecretKey</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-71"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">elements</span><span> </span><a href="Pos.Crypto.Arbitrary.html#redemptionKeys"><span class="hs-identifier hs-var">redemptionKeys</span></a><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-keyword">instance</span><span> </span><a href="Pos.Util.Arbitrary.html#Nonrepeating"><span class="hs-identifier hs-type">Nonrepeating</span></a><span> </span><span class="hs-identifier hs-type">RedeemPublicKey</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-74"></a><span>    </span><a name="local-8214565720323932775"><a href="Pos.Util.Arbitrary.html#nonrepeating"><span class="hs-identifier">nonrepeating</span></a></a><span> </span><a name="local-6989586621679528328"><a href="#local-6989586621679528328"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Pos.Util.Arbitrary.html#sublistN"><span class="hs-identifier hs-var">sublistN</span></a><span> </span><a href="#local-6989586621679528328"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="Pos.Crypto.Arbitrary.html#redemptionKeys"><span class="hs-identifier hs-var">redemptionKeys</span></a><span>
</span><a name="line-75"></a><span class="hs-keyword">instance</span><span> </span><a href="Pos.Util.Arbitrary.html#Nonrepeating"><span class="hs-identifier hs-type">Nonrepeating</span></a><span> </span><span class="hs-identifier hs-type">RedeemSecretKey</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-76"></a><span>    </span><a name="local-8214565720323932775"><a href="Pos.Util.Arbitrary.html#nonrepeating"><span class="hs-identifier">nonrepeating</span></a></a><span> </span><a name="local-6989586621679528327"><a href="#local-6989586621679528327"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Pos.Util.Arbitrary.html#sublistN"><span class="hs-identifier hs-var">sublistN</span></a><span> </span><a href="#local-6989586621679528327"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="Pos.Crypto.Arbitrary.html#redemptionKeys"><span class="hs-identifier hs-var">redemptionKeys</span></a><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-79"></a><span class="hs-comment">-- Arbitrary VSS keys</span><span>
</span><a name="line-80"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-identifier">vssKeys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">VssKeyPair</span><span class="hs-special">]</span><span>
</span><a name="line-83"></a><a name="vssKeys"><a href="Pos.Crypto.Arbitrary.html#vssKeys"><span class="hs-identifier">vssKeys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Util.Arbitrary.html#unsafeMakePool"><span class="hs-identifier hs-var">unsafeMakePool</span></a><span> </span><span class="hs-string">&quot;[generating VSS keys for tests...]&quot;</span><span> </span><span class="hs-number">50</span><span> </span><span class="hs-identifier hs-var">vssKeyGen</span><span>
</span><a name="line-84"></a><span class="hs-pragma">{-# NOINLINE vssKeys #-}</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-identifier hs-type">VssKeyPair</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-87"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">elements</span><span> </span><a href="Pos.Crypto.Arbitrary.html#vssKeys"><span class="hs-identifier hs-var">vssKeys</span></a><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-identifier hs-type">VssPublicKey</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-90"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toVssPublicKey</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">AsBinary</span><span> </span><span class="hs-identifier hs-type">VssPublicKey</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-93"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">asBinary</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">VssPublicKey</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-keyword">instance</span><span> </span><a href="Pos.Util.Arbitrary.html#Nonrepeating"><span class="hs-identifier hs-type">Nonrepeating</span></a><span> </span><span class="hs-identifier hs-type">VssKeyPair</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-96"></a><span>    </span><a name="local-8214565720323932775"><a href="Pos.Util.Arbitrary.html#nonrepeating"><span class="hs-identifier">nonrepeating</span></a></a><span> </span><a name="local-6989586621679528326"><a href="#local-6989586621679528326"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Util.Arbitrary.html#sublistN"><span class="hs-identifier hs-var">sublistN</span></a><span> </span><a href="#local-6989586621679528326"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="Pos.Crypto.Arbitrary.html#vssKeys"><span class="hs-identifier hs-var">vssKeys</span></a><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-keyword">instance</span><span> </span><a href="Pos.Util.Arbitrary.html#Nonrepeating"><span class="hs-identifier hs-type">Nonrepeating</span></a><span> </span><span class="hs-identifier hs-type">VssPublicKey</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-99"></a><span>    </span><a name="local-8214565720323932775"><a href="Pos.Util.Arbitrary.html#nonrepeating"><span class="hs-identifier">nonrepeating</span></a></a><span> </span><a name="local-6989586621679528325"><a href="#local-6989586621679528325"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">toVssPublicKey</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Pos.Util.Arbitrary.html#nonrepeating"><span class="hs-identifier hs-var">nonrepeating</span></a><span> </span><a href="#local-6989586621679528325"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-102"></a><span class="hs-comment">-- Arbitrary signatures</span><span>
</span><a name="line-103"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bi</span><span> </span><a href="#local-6989586621679528324"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="#local-6989586621679528324"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Signature</span><span> </span><a href="#local-6989586621679528324"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-106"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sign</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bi</span><span> </span><a href="#local-6989586621679528323"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="#local-6989586621679528323"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">RedeemSignature</span><span> </span><a href="#local-6989586621679528323"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-109"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">redeemSign</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bi</span><span> </span><a href="#local-6989586621679528322"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="#local-6989586621679528322"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Signed</span><span> </span><a href="#local-6989586621679528322"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-112"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkSigned</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bi</span><span> </span><a href="#local-6989586621679528321"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="#local-6989586621679528321"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ProxyCert</span><span> </span><a href="#local-6989586621679528321"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-115"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA3</span><span> </span><span class="hs-identifier hs-var">createProxyCert</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bi</span><span> </span><a href="#local-6989586621679528320"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="#local-6989586621679528320"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ProxySecretKey</span><span> </span><a href="#local-6989586621679528320"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-118"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA3</span><span> </span><span class="hs-identifier hs-var">createProxySecretKey</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-119"></a><span>
</span><a name="line-120"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bi</span><span> </span><a href="#local-6989586621679528314"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="#local-6989586621679528314"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bi</span><span> </span><a href="#local-6989586621679528315"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="#local-6989586621679528315"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-121"></a><span>         </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ProxySignature</span><span> </span><a href="#local-6989586621679528314"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679528315"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-122"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-123"></a><span>        </span><a name="local-6989586621679528316"><a href="#local-6989586621679528316"><span class="hs-identifier">delegateSk</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-124"></a><span>        </span><a name="local-6989586621679528317"><a href="#local-6989586621679528317"><span class="hs-identifier">issuerSk</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-125"></a><span>        </span><a name="local-6989586621679528318"><a href="#local-6989586621679528318"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-126"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679528319"><a href="#local-6989586621679528319"><span class="hs-identifier">psk</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">createProxySecretKey</span><span> </span><a href="#local-6989586621679528317"><span class="hs-identifier hs-var">issuerSk</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toPublic</span><span> </span><a href="#local-6989586621679528316"><span class="hs-identifier hs-var">delegateSk</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679528318"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-127"></a><span>        </span><span class="hs-identifier hs-var">proxySign</span><span> </span><a href="#local-6989586621679528316"><span class="hs-identifier hs-var">delegateSk</span></a><span> </span><a href="#local-6989586621679528319"><span class="hs-identifier hs-var">psk</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-130"></a><span class="hs-comment">-- Arbitrary secrets</span><span>
</span><a name="line-131"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-identifier">sharedSecrets</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">SecretSharingExtra</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Secret</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">SecretProof</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">EncShare</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-134"></a><a name="sharedSecrets"><a href="Pos.Crypto.Arbitrary.html#sharedSecrets"><span class="hs-identifier">sharedSecrets</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-135"></a><span>    </span><a href="Pos.Util.Arbitrary.html#unsafeMakePool"><span class="hs-identifier hs-var">unsafeMakePool</span></a><span> </span><span class="hs-string">&quot;[generating shared secrets for tests...]&quot;</span><span> </span><span class="hs-number">50</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-136"></a><span>        </span><a name="local-6989586621679528288"><a href="#local-6989586621679528288"><span class="hs-identifier">parties</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">generate</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">choose</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="Pos.Crypto.Arbitrary.html#vssKeys"><span class="hs-identifier hs-var">vssKeys</span></a><span class="hs-special">)</span><span>
</span><a name="line-137"></a><span>        </span><a name="local-6989586621679528289"><a href="#local-6989586621679528289"><span class="hs-identifier">threshold</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">generate</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">choose</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><a href="#local-6989586621679528288"><span class="hs-identifier hs-var">parties</span></a><span class="hs-special">)</span><span>
</span><a name="line-138"></a><span>        </span><a name="local-6989586621679528290"><a href="#local-6989586621679528290"><span class="hs-identifier">vssKs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">generate</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pos.Util.Arbitrary.html#sublistN"><span class="hs-identifier hs-var">sublistN</span></a><span> </span><a href="#local-6989586621679528288"><span class="hs-identifier hs-var">parties</span></a><span> </span><a href="Pos.Crypto.Arbitrary.html#vssKeys"><span class="hs-identifier hs-var">vssKeys</span></a><span>
</span><a name="line-139"></a><span>        </span><span class="hs-identifier hs-var">genSharedSecret</span><span> </span><a href="#local-6989586621679528289"><span class="hs-identifier hs-var">threshold</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">toVssPublicKey</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromList</span><span> </span><a href="#local-6989586621679528290"><span class="hs-identifier hs-var">vssKs</span></a><span class="hs-special">)</span><span>
</span><a name="line-140"></a><span class="hs-pragma">{-# NOINLINE sharedSecrets #-}</span><span>
</span><a name="line-141"></a><span>
</span><a name="line-142"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-identifier hs-type">SecretSharingExtra</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-143"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">elements</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><span class="hs-identifier hs-var">_1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pos.Crypto.Arbitrary.html#sharedSecrets"><span class="hs-identifier hs-var">sharedSecrets</span></a><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">AsBinary</span><span> </span><span class="hs-identifier hs-type">SecretSharingExtra</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-146"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">asBinary</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">SecretSharingExtra</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">AsBinary</span><span> </span><span class="hs-identifier hs-type">SecretProof</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-149"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">asBinary</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">SecretProof</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-identifier hs-type">Secret</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-152"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">elements</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><span class="hs-identifier hs-var">_2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pos.Crypto.Arbitrary.html#sharedSecrets"><span class="hs-identifier hs-var">sharedSecrets</span></a><span>
</span><a name="line-153"></a><span>
</span><a name="line-154"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">AsBinary</span><span> </span><span class="hs-identifier hs-type">Secret</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-155"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">asBinary</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">Secret</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-identifier hs-type">SecretProof</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-158"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">elements</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><span class="hs-identifier hs-var">_3</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pos.Crypto.Arbitrary.html#sharedSecrets"><span class="hs-identifier hs-var">sharedSecrets</span></a><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-identifier hs-type">EncShare</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-161"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">elements</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><span class="hs-identifier hs-var">_4</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pos.Crypto.Arbitrary.html#sharedSecrets"><span class="hs-identifier hs-var">sharedSecrets</span></a><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">AsBinary</span><span> </span><span class="hs-identifier hs-type">EncShare</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-164"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">asBinary</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">EncShare</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-identifier hs-type">Share</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-167"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">decryptShare</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span class="hs-special">)</span><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">AsBinary</span><span> </span><span class="hs-identifier hs-type">Share</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-170"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">asBinary</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">Share</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-173"></a><span class="hs-comment">-- Arbitrary hashes</span><span>
</span><a name="line-174"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HashAlgorithm</span><span> </span><a href="#local-6989586621679528291"><span class="hs-identifier hs-type">algo</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bi</span><span> </span><a href="#local-6989586621679528292"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">AbstractHash</span><span> </span><a href="#local-6989586621679528291"><span class="hs-identifier hs-type">algo</span></a><span> </span><a href="#local-6989586621679528292"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-177"></a><span>    </span><a name="local-8214565720323785628"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Util.Arbitrary.html#arbitraryUnsafe"><span class="hs-identifier hs-var">arbitraryUnsafe</span></a><span>
</span><a name="line-178"></a></pre></body></html>
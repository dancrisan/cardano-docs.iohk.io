<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">-- | `Arbitrary` instances for using in tests and benchmarks</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">Arbitrary</span><span>
</span><a name="line-6"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="Pos.Crypto.Arbitrary.html#KeyPair"><span class="hs-identifier hs-type">KeyPair</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-7"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span class="hs-operator">.</span><span class="hs-identifier">NonEmpty</span><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromList</span><span class="hs-special">)</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span class="hs-operator">.</span><span class="hs-identifier">Unsafe</span><span>            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unsafePerformIO</span><span class="hs-special">)</span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Test</span><span class="hs-operator">.</span><span class="hs-identifier">QuickCheck</span><span>             </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">choose</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">elements</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">generate</span><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Universum</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Binary.Class.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Binary</span><span class="hs-operator">.</span><span class="hs-identifier">Class</span></a><span>            </span><span class="hs-special">(</span><a href="Pos.Binary.Class.html#Bi"><span class="hs-identifier hs-type">Bi</span></a><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Crypto.Arbitrary.Hash.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">Arbitrary</span><span class="hs-operator">.</span><span class="hs-identifier">Hash</span></a><span>   </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Crypto.Arbitrary.Unsafe.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">Arbitrary</span><span class="hs-operator">.</span><span class="hs-identifier">Unsafe</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Crypto.AsBinary.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">AsBinary</span></a><span>         </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Crypto.SecretSharing.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">SecretSharing</span></a><span>    </span><span class="hs-special">(</span><a href="Pos.Crypto.SecretSharing.html#EncShare"><span class="hs-identifier hs-type">EncShare</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.SecretSharing.html#Secret"><span class="hs-identifier hs-type">Secret</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.SecretSharing.html#SecretProof"><span class="hs-identifier hs-type">SecretProof</span></a><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>                                              </span><a href="Pos.Crypto.SecretSharing.html#SecretSharingExtra"><span class="hs-identifier hs-type">SecretSharingExtra</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.SecretSharing.html#Share"><span class="hs-identifier hs-type">Share</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.SecretSharing.html#VssKeyPair"><span class="hs-identifier hs-type">VssKeyPair</span></a><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>                                              </span><a href="Pos.Crypto.SecretSharing.html#VssPublicKey"><span class="hs-identifier hs-type">VssPublicKey</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.SecretSharing.html#decryptShare"><span class="hs-identifier hs-var">decryptShare</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.SecretSharing.html#genSharedSecret"><span class="hs-identifier hs-var">genSharedSecret</span></a><span class="hs-special">,</span><span>
</span><a name="line-21"></a><span>                                              </span><a href="Pos.Crypto.SecretSharing.html#toVssPublicKey"><span class="hs-identifier hs-var">toVssPublicKey</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.SecretSharing.html#vssKeyGen"><span class="hs-identifier hs-var">vssKeyGen</span></a><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Crypto.Signing.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">Signing</span></a><span>          </span><span class="hs-special">(</span><a href="Pos.Crypto.Signing.html#ProxyCert"><span class="hs-identifier hs-type">ProxyCert</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.Signing.html#ProxySecretKey"><span class="hs-identifier hs-type">ProxySecretKey</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.Signing.html#ProxySignature"><span class="hs-identifier hs-type">ProxySignature</span></a><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>                                              </span><a href="Pos.Crypto.Signing.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.Signing.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.Signing.html#Signature"><span class="hs-identifier hs-type">Signature</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.Signing.html#Signed"><span class="hs-identifier hs-type">Signed</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>                                              </span><a href="Pos.Crypto.Signing.html#createProxyCert"><span class="hs-identifier hs-var">createProxyCert</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.Signing.html#createProxySecretKey"><span class="hs-identifier hs-var">createProxySecretKey</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>                                              </span><a href="Pos.Crypto.Signing.html#keyGen"><span class="hs-identifier hs-var">keyGen</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.Signing.html#mkSigned"><span class="hs-identifier hs-var">mkSigned</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.Signing.html#proxySign"><span class="hs-identifier hs-var">proxySign</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.Signing.html#sign"><span class="hs-identifier hs-var">sign</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.Signing.html#toPublic"><span class="hs-identifier hs-var">toPublic</span></a><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Util.Arbitrary.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Util</span><span class="hs-operator">.</span><span class="hs-identifier">Arbitrary</span></a><span>          </span><span class="hs-special">(</span><a href="Pos.Util.Arbitrary.html#Nonrepeating"><span class="hs-identifier hs-type">Nonrepeating</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Pos.Util.Arbitrary.html#sublistN"><span class="hs-identifier hs-var">sublistN</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Util.Arbitrary.html#unsafeMakePool"><span class="hs-identifier hs-var">unsafeMakePool</span></a><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Util.Binary.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Util</span><span class="hs-operator">.</span><span class="hs-identifier">Binary</span></a><span>             </span><span class="hs-special">(</span><a href="Pos.Util.Binary.html#AsBinary"><span class="hs-identifier hs-type">AsBinary</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Pos.Util.Binary.html#AsBinaryClass"><span class="hs-identifier hs-type">AsBinaryClass</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-comment">{- A note on 'Arbitrary' instances
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

We can't make an 'Arbitrary' instance for keys or seeds because generating
them safely requires randomness which must come from IO (we could use an
'arbitrary' randomness generator for an 'Arbitrary' instance, but then what's
the point of testing key generation when we use different generators in
production and in tests?). So, we just generate lots of keys and seeds with
'unsafePerformIO' and use them for everything.
-}</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-41"></a><span class="hs-comment">-- Arbitrary signing keys</span><span>
</span><a name="line-42"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-comment">-- | 'PublicKey' with corresponding 'SecretKey'.</span><span>
</span><a name="line-45"></a><span class="hs-keyword">data</span><span> </span><a name="KeyPair"><a href="Pos.Crypto.Arbitrary.html#KeyPair"><span class="hs-identifier">KeyPair</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="KeyPair"><a href="Pos.Crypto.Arbitrary.html#KeyPair"><span class="hs-identifier">KeyPair</span></a></a><span>
</span><a name="line-46"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="getPub"><a href="Pos.Crypto.Arbitrary.html#getPub"><span class="hs-identifier">getPub</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Pos.Crypto.Signing.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a><span>
</span><a name="line-47"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="getSec"><a href="Pos.Crypto.Arbitrary.html#getSec"><span class="hs-identifier">getSec</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Pos.Crypto.Signing.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a><span>
</span><a name="line-48"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-identifier">keys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Pos.Crypto.Arbitrary.html#KeyPair"><span class="hs-identifier hs-type">KeyPair</span></a><span class="hs-special">]</span><span>
</span><a name="line-51"></a><a name="keys"><a href="Pos.Crypto.Arbitrary.html#keys"><span class="hs-identifier">keys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Util.Arbitrary.html#unsafeMakePool"><span class="hs-identifier hs-var">unsafeMakePool</span></a><span> </span><span class="hs-string">&quot;[generating keys for tests...]&quot;</span><span> </span><span class="hs-number">50</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="Pos.Crypto.Arbitrary.html#KeyPair"><span class="hs-identifier hs-var">KeyPair</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Pos.Crypto.Signing.html#keyGen"><span class="hs-identifier hs-var">keyGen</span></a><span>
</span><a name="line-52"></a><span class="hs-pragma">{-# NOINLINE keys #-}</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="Pos.Crypto.Arbitrary.html#KeyPair"><span class="hs-identifier hs-type">KeyPair</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-55"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">elements</span><span> </span><a href="Pos.Crypto.Arbitrary.html#keys"><span class="hs-identifier hs-var">keys</span></a><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="Pos.Crypto.Signing.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-58"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">getPub</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-59"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="Pos.Crypto.Signing.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-60"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">getSec</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-keyword">instance</span><span> </span><a href="Pos.Util.Arbitrary.html#Nonrepeating"><span class="hs-identifier hs-type">Nonrepeating</span></a><span> </span><a href="Pos.Crypto.Arbitrary.html#KeyPair"><span class="hs-identifier hs-type">KeyPair</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-63"></a><span>    </span><a name="local-8214565720323865040"><a href="Pos.Util.Arbitrary.html#nonrepeating"><span class="hs-identifier">nonrepeating</span></a></a><span> </span><a name="local-6989586621679407885"><a href="#local-6989586621679407885"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Util.Arbitrary.html#sublistN"><span class="hs-identifier hs-var">sublistN</span></a><span> </span><a href="#local-6989586621679407885"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="Pos.Crypto.Arbitrary.html#keys"><span class="hs-identifier hs-var">keys</span></a><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-keyword">instance</span><span> </span><a href="Pos.Util.Arbitrary.html#Nonrepeating"><span class="hs-identifier hs-type">Nonrepeating</span></a><span> </span><a href="Pos.Crypto.Signing.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-66"></a><span>    </span><a name="local-8214565720323865040"><a href="Pos.Util.Arbitrary.html#nonrepeating"><span class="hs-identifier">nonrepeating</span></a></a><span> </span><a name="local-6989586621679407884"><a href="#local-6989586621679407884"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">getPub</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Pos.Util.Arbitrary.html#nonrepeating"><span class="hs-identifier hs-var">nonrepeating</span></a><span> </span><a href="#local-6989586621679407884"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-67"></a><span class="hs-keyword">instance</span><span> </span><a href="Pos.Util.Arbitrary.html#Nonrepeating"><span class="hs-identifier hs-type">Nonrepeating</span></a><span> </span><a href="Pos.Crypto.Signing.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-68"></a><span>    </span><a name="local-8214565720323865040"><a href="Pos.Util.Arbitrary.html#nonrepeating"><span class="hs-identifier">nonrepeating</span></a></a><span> </span><a name="local-6989586621679407883"><a href="#local-6989586621679407883"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">getSec</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Pos.Util.Arbitrary.html#nonrepeating"><span class="hs-identifier hs-var">nonrepeating</span></a><span> </span><a href="#local-6989586621679407883"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-71"></a><span class="hs-comment">-- Arbitrary VSS keys</span><span>
</span><a name="line-72"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-identifier">vssKeys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Pos.Crypto.SecretSharing.html#VssKeyPair"><span class="hs-identifier hs-type">VssKeyPair</span></a><span class="hs-special">]</span><span>
</span><a name="line-75"></a><a name="vssKeys"><a href="Pos.Crypto.Arbitrary.html#vssKeys"><span class="hs-identifier">vssKeys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Util.Arbitrary.html#unsafeMakePool"><span class="hs-identifier hs-var">unsafeMakePool</span></a><span> </span><span class="hs-string">&quot;[generating VSS keys for tests...]&quot;</span><span> </span><span class="hs-number">50</span><span> </span><a href="Pos.Crypto.SecretSharing.html#vssKeyGen"><span class="hs-identifier hs-var">vssKeyGen</span></a><span>
</span><a name="line-76"></a><span class="hs-pragma">{-# NOINLINE vssKeys #-}</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="Pos.Crypto.SecretSharing.html#VssKeyPair"><span class="hs-identifier hs-type">VssKeyPair</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-79"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">elements</span><span> </span><a href="Pos.Crypto.Arbitrary.html#vssKeys"><span class="hs-identifier hs-var">vssKeys</span></a><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="Pos.Crypto.SecretSharing.html#VssPublicKey"><span class="hs-identifier hs-type">VssPublicKey</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-82"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Crypto.SecretSharing.html#toVssPublicKey"><span class="hs-identifier hs-var">toVssPublicKey</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><a href="Pos.Util.Binary.html#AsBinary"><span class="hs-identifier hs-type">AsBinary</span></a><span> </span><a href="Pos.Crypto.SecretSharing.html#VssPublicKey"><span class="hs-identifier hs-type">VssPublicKey</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-85"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Util.Binary.html#asBinary"><span class="hs-identifier hs-var">asBinary</span></a><span> </span><span class="hs-glyph">@</span><a href="Pos.Crypto.SecretSharing.html#VssPublicKey"><span class="hs-identifier hs-type">VssPublicKey</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-keyword">instance</span><span> </span><a href="Pos.Util.Arbitrary.html#Nonrepeating"><span class="hs-identifier hs-type">Nonrepeating</span></a><span> </span><a href="Pos.Crypto.SecretSharing.html#VssKeyPair"><span class="hs-identifier hs-type">VssKeyPair</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-88"></a><span>    </span><a name="local-8214565720323865040"><a href="Pos.Util.Arbitrary.html#nonrepeating"><span class="hs-identifier">nonrepeating</span></a></a><span> </span><a name="local-6989586621679407882"><a href="#local-6989586621679407882"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Util.Arbitrary.html#sublistN"><span class="hs-identifier hs-var">sublistN</span></a><span> </span><a href="#local-6989586621679407882"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="Pos.Crypto.Arbitrary.html#vssKeys"><span class="hs-identifier hs-var">vssKeys</span></a><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-keyword">instance</span><span> </span><a href="Pos.Util.Arbitrary.html#Nonrepeating"><span class="hs-identifier hs-type">Nonrepeating</span></a><span> </span><a href="Pos.Crypto.SecretSharing.html#VssPublicKey"><span class="hs-identifier hs-type">VssPublicKey</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-91"></a><span>    </span><a name="local-8214565720323865040"><a href="Pos.Util.Arbitrary.html#nonrepeating"><span class="hs-identifier">nonrepeating</span></a></a><span> </span><a name="local-6989586621679407881"><a href="#local-6989586621679407881"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Pos.Crypto.SecretSharing.html#toVssPublicKey"><span class="hs-identifier hs-var">toVssPublicKey</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Pos.Util.Arbitrary.html#nonrepeating"><span class="hs-identifier hs-var">nonrepeating</span></a><span> </span><a href="#local-6989586621679407881"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-94"></a><span class="hs-comment">-- Arbitrary signatures</span><span>
</span><a name="line-95"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Pos.Binary.Class.html#Bi"><span class="hs-identifier hs-type">Bi</span></a><span> </span><a href="#local-6989586621679407880"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="#local-6989586621679407880"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><a href="Pos.Crypto.Signing.html#Signature"><span class="hs-identifier hs-type">Signature</span></a><span> </span><a href="#local-6989586621679407880"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-98"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Crypto.Signing.html#sign"><span class="hs-identifier hs-var">sign</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Pos.Binary.Class.html#Bi"><span class="hs-identifier hs-type">Bi</span></a><span> </span><a href="#local-6989586621679407879"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="#local-6989586621679407879"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><a href="Pos.Crypto.Signing.html#Signed"><span class="hs-identifier hs-type">Signed</span></a><span> </span><a href="#local-6989586621679407879"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-101"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Crypto.Signing.html#mkSigned"><span class="hs-identifier hs-var">mkSigned</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Pos.Binary.Class.html#Bi"><span class="hs-identifier hs-type">Bi</span></a><span> </span><a href="#local-6989586621679407878"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="#local-6989586621679407878"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><a href="Pos.Crypto.Signing.html#ProxyCert"><span class="hs-identifier hs-type">ProxyCert</span></a><span> </span><a href="#local-6989586621679407878"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-104"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA3</span><span> </span><a href="Pos.Crypto.Signing.html#createProxyCert"><span class="hs-identifier hs-var">createProxyCert</span></a><span> </span><span class="hs-identifier hs-var">arbitrary</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Pos.Binary.Class.html#Bi"><span class="hs-identifier hs-type">Bi</span></a><span> </span><a href="#local-6989586621679407877"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="#local-6989586621679407877"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><a href="Pos.Crypto.Signing.html#ProxySecretKey"><span class="hs-identifier hs-type">ProxySecretKey</span></a><span> </span><a href="#local-6989586621679407877"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-107"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA3</span><span> </span><a href="Pos.Crypto.Signing.html#createProxySecretKey"><span class="hs-identifier hs-var">createProxySecretKey</span></a><span> </span><span class="hs-identifier hs-var">arbitrary</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Pos.Binary.Class.html#Bi"><span class="hs-identifier hs-type">Bi</span></a><span> </span><a href="#local-6989586621679407871"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="#local-6989586621679407871"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Binary.Class.html#Bi"><span class="hs-identifier hs-type">Bi</span></a><span> </span><a href="#local-6989586621679407872"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="#local-6989586621679407872"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-110"></a><span>         </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><a href="Pos.Crypto.Signing.html#ProxySignature"><span class="hs-identifier hs-type">ProxySignature</span></a><span> </span><a href="#local-6989586621679407871"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679407872"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-111"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-112"></a><span>        </span><a name="local-6989586621679407873"><a href="#local-6989586621679407873"><span class="hs-identifier">delegateSk</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-113"></a><span>        </span><a name="local-6989586621679407874"><a href="#local-6989586621679407874"><span class="hs-identifier">issuerSk</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-114"></a><span>        </span><a name="local-6989586621679407875"><a href="#local-6989586621679407875"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-115"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679407876"><a href="#local-6989586621679407876"><span class="hs-identifier">psk</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Crypto.Signing.html#createProxySecretKey"><span class="hs-identifier hs-var">createProxySecretKey</span></a><span> </span><a href="#local-6989586621679407874"><span class="hs-identifier hs-var">issuerSk</span></a><span> </span><span class="hs-special">(</span><a href="Pos.Crypto.Signing.html#toPublic"><span class="hs-identifier hs-var">toPublic</span></a><span> </span><a href="#local-6989586621679407873"><span class="hs-identifier hs-var">delegateSk</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679407875"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-116"></a><span>        </span><a href="Pos.Crypto.Signing.html#proxySign"><span class="hs-identifier hs-var">proxySign</span></a><span> </span><a href="#local-6989586621679407873"><span class="hs-identifier hs-var">delegateSk</span></a><span> </span><a href="#local-6989586621679407876"><span class="hs-identifier hs-var">psk</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-119"></a><span class="hs-comment">-- Arbitrary secrets</span><span>
</span><a name="line-120"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-identifier">sharedSecrets</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Pos.Crypto.SecretSharing.html#SecretSharingExtra"><span class="hs-identifier hs-type">SecretSharingExtra</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.SecretSharing.html#Secret"><span class="hs-identifier hs-type">Secret</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.SecretSharing.html#SecretProof"><span class="hs-identifier hs-type">SecretProof</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Pos.Crypto.SecretSharing.html#EncShare"><span class="hs-identifier hs-type">EncShare</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-123"></a><a name="sharedSecrets"><a href="Pos.Crypto.Arbitrary.html#sharedSecrets"><span class="hs-identifier">sharedSecrets</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-124"></a><span>    </span><a href="Pos.Util.Arbitrary.html#unsafeMakePool"><span class="hs-identifier hs-var">unsafeMakePool</span></a><span> </span><span class="hs-string">&quot;[generating shared secrets for tests...]&quot;</span><span> </span><span class="hs-number">50</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-125"></a><span>        </span><a name="local-6989586621679407831"><a href="#local-6989586621679407831"><span class="hs-identifier">parties</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">generate</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">choose</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="Pos.Crypto.Arbitrary.html#vssKeys"><span class="hs-identifier hs-var">vssKeys</span></a><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span>        </span><a name="local-6989586621679407832"><a href="#local-6989586621679407832"><span class="hs-identifier">threshold</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">generate</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">choose</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><a href="#local-6989586621679407831"><span class="hs-identifier hs-var">parties</span></a><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span>        </span><a name="local-6989586621679407833"><a href="#local-6989586621679407833"><span class="hs-identifier">vssKs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">generate</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pos.Util.Arbitrary.html#sublistN"><span class="hs-identifier hs-var">sublistN</span></a><span> </span><a href="#local-6989586621679407831"><span class="hs-identifier hs-var">parties</span></a><span> </span><a href="Pos.Crypto.Arbitrary.html#vssKeys"><span class="hs-identifier hs-var">vssKeys</span></a><span>
</span><a name="line-128"></a><span>        </span><a href="Pos.Crypto.SecretSharing.html#genSharedSecret"><span class="hs-identifier hs-var">genSharedSecret</span></a><span> </span><a href="#local-6989586621679407832"><span class="hs-identifier hs-var">threshold</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="Pos.Crypto.SecretSharing.html#toVssPublicKey"><span class="hs-identifier hs-var">toVssPublicKey</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromList</span><span> </span><a href="#local-6989586621679407833"><span class="hs-identifier hs-var">vssKs</span></a><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span class="hs-pragma">{-# NOINLINE sharedSecrets #-}</span><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="Pos.Crypto.SecretSharing.html#SecretSharingExtra"><span class="hs-identifier hs-type">SecretSharingExtra</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-132"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">elements</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><span class="hs-identifier hs-var">_1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pos.Crypto.Arbitrary.html#sharedSecrets"><span class="hs-identifier hs-var">sharedSecrets</span></a><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><a href="Pos.Util.Binary.html#AsBinary"><span class="hs-identifier hs-type">AsBinary</span></a><span> </span><a href="Pos.Crypto.SecretSharing.html#SecretSharingExtra"><span class="hs-identifier hs-type">SecretSharingExtra</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-135"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Util.Binary.html#asBinary"><span class="hs-identifier hs-var">asBinary</span></a><span> </span><span class="hs-glyph">@</span><a href="Pos.Crypto.SecretSharing.html#SecretSharingExtra"><span class="hs-identifier hs-type">SecretSharingExtra</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><a href="Pos.Util.Binary.html#AsBinary"><span class="hs-identifier hs-type">AsBinary</span></a><span> </span><a href="Pos.Crypto.SecretSharing.html#SecretProof"><span class="hs-identifier hs-type">SecretProof</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-138"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Util.Binary.html#asBinary"><span class="hs-identifier hs-var">asBinary</span></a><span> </span><span class="hs-glyph">@</span><a href="Pos.Crypto.SecretSharing.html#SecretProof"><span class="hs-identifier hs-type">SecretProof</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="Pos.Crypto.SecretSharing.html#Secret"><span class="hs-identifier hs-type">Secret</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-141"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">elements</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><span class="hs-identifier hs-var">_2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pos.Crypto.Arbitrary.html#sharedSecrets"><span class="hs-identifier hs-var">sharedSecrets</span></a><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><a href="Pos.Util.Binary.html#AsBinary"><span class="hs-identifier hs-type">AsBinary</span></a><span> </span><a href="Pos.Crypto.SecretSharing.html#Secret"><span class="hs-identifier hs-type">Secret</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-144"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Util.Binary.html#asBinary"><span class="hs-identifier hs-var">asBinary</span></a><span> </span><span class="hs-glyph">@</span><a href="Pos.Crypto.SecretSharing.html#Secret"><span class="hs-identifier hs-type">Secret</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="Pos.Crypto.SecretSharing.html#SecretProof"><span class="hs-identifier hs-type">SecretProof</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-147"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">elements</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><span class="hs-identifier hs-var">_3</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pos.Crypto.Arbitrary.html#sharedSecrets"><span class="hs-identifier hs-var">sharedSecrets</span></a><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="Pos.Crypto.SecretSharing.html#EncShare"><span class="hs-identifier hs-type">EncShare</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-150"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">elements</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><span class="hs-identifier hs-var">_4</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pos.Crypto.Arbitrary.html#sharedSecrets"><span class="hs-identifier hs-var">sharedSecrets</span></a><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><a href="Pos.Util.Binary.html#AsBinary"><span class="hs-identifier hs-type">AsBinary</span></a><span> </span><a href="Pos.Crypto.SecretSharing.html#EncShare"><span class="hs-identifier hs-type">EncShare</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-153"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Util.Binary.html#asBinary"><span class="hs-identifier hs-var">asBinary</span></a><span> </span><span class="hs-glyph">@</span><a href="Pos.Crypto.SecretSharing.html#EncShare"><span class="hs-identifier hs-type">EncShare</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="Pos.Crypto.SecretSharing.html#Share"><span class="hs-identifier hs-type">Share</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-156"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><a href="Pos.Crypto.SecretSharing.html#decryptShare"><span class="hs-identifier hs-var">decryptShare</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><a href="Pos.Util.Binary.html#AsBinary"><span class="hs-identifier hs-type">AsBinary</span></a><span> </span><a href="Pos.Crypto.SecretSharing.html#Share"><span class="hs-identifier hs-type">Share</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-159"></a><span>    </span><a name="local-8214565720323836676"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Util.Binary.html#asBinary"><span class="hs-identifier hs-var">asBinary</span></a><span> </span><span class="hs-glyph">@</span><a href="Pos.Crypto.SecretSharing.html#Share"><span class="hs-identifier hs-type">Share</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-160"></a></pre></body></html>